// NPC que controla quem matou os totems

002.gat,107,115,0	script	#Controle	45,{

	end;

L_Iniciar:
	monster "002.gat", 93, 105, "", 1014, 1, "#Controle::OnTotem1Death";
	monster "002.gat", 93, 100, "", 1014, 1, "#Controle::OnTotem2Death";
	monster "002.gat", 93, 95, "", 1014, 1, "#Controle::OnTotem3Death";
	monster "002.gat", 93, 90, "", 1014, 1, "#Controle::OnTotem4Death";
	monster "002.gat", 93, 85, "", 1014, 1, "#Controle::OnTotem5Death";
	monster "002.gat", 105, 105, "", 1014, 1, "#Controle::OnTotem6Death";
	monster "002.gat", 105, 100, "", 1014, 1, "#Controle::OnTotem7Death";
	monster "002.gat", 105, 95, "", 1014, 1, "#Controle::OnTotem8Death";
	monster "002.gat", 105, 90, "", 1014, 1, "#Controle::OnTotem9Death";
	monster "002.gat", 105, 85, "", 1014, 1, "#Controle::OnTotem10Death";
	monster "002.gat", 101, 85, "", 1014, 1, "#Controle::OnTotem11Death";
	monster "002.gat", 97, 85, "", 1014, 1, "#Controle::OnTotem12Death";
	set $@EVENTO_STATUS, 1;
	set $@EVENTO_DEBUG, 1;
	set $@EVENTO_INICIO, gettimetick(2);
	set $CONTROLE_EVENTOS, $CONTROLE_EVENTOS + 1;
	set $@VENCEDOR_TOTENS, 0;
	set $@VENCEDOR, 0;
	set $@VENCEDOR_MORTES, 0;
	set $@VENCEDOR_MORTES_GRUPO, 0;
	cleararray $@EMPATADOS_MORTES[0], 0, 13;
	cleararray $@EMPATADOS[0], 0, 13;
	enablenpc "Danboudor";
	end;

OnTimer5000:
	setnpctimer 0;
//	if (gettime(4) != 6 || gettime(3) < 18) end;
//	if (gettime(3) > 20 && $@EVENTO_STATUS == 1) goto L_Limpar;
//	if (gettime(3) == 18 || (gettime(3) == 19 && gettime(2) == 0)) goto L_Anuncios;
//	Modo debug
	if ($@EVENTO_STATUS == 0 && $@EVENTO_DEBUG == 1) goto L_Iniciar;
	if ($@EVENTO_STATUS == 1 && $@EVENTO_DEBUG == 0) goto L_Limpar;
	if ($@EVENTO_STATUS == 1) goto L_Checar_Tempo;
	if ($@EVENTO_STATUS == 0 && $@EVENTO_DEBUG == 2) goto L_Anuncios;
// Dar até o final do domingo para os jogadores pegar o prêmio. Colocar o "gettime" depois
	if ($@DISABLEDAN > 0) set $@DISABLEDAN, $@DISABLEDAN + 1;
	if ($@DISABLEDAN == 13) disablenpc "Danboudor";
	if ($@DISABLEDAN == 13) set $@DISABLEDAN, 0;
	if ($@DISABLEDAN == 11) announce "10 segundos para o danboudor ir embora!", 0;
	if ($@DISABLEDAN == 7) announce "30 segundos para o danboudor ir embora!", 0;
	if ($@DISABLEDAN == 2) announce "60 segundos para o danboudor ir embora!", 0;
	end;

OnTotem1Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@Totemdono[1] != @loop) announce "O Pilar de Aries foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@Totemdono[1] != @loop) set $@Totemdono[1], @loop;
	monster "002.gat", 93, 105, "", 1014, 1, "#Controle::OnTotem1Death";
	end;

OnTotem2Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@Totemdono[2] != @loop) announce "O Pilar de Touro foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@Totemdono[2] != @loop) set $@Totemdono[2], @loop;
	monster "002.gat", 93, 100, "", 1014, 1, "#Controle::OnTotem2Death";
	end;

OnTotem3Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@Totemdono[3] != @loop) announce "O Pilar de Gêmeos foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@Totemdono[3] != @loop) set $@Totemdono[3], @loop;
	monster "002.gat", 93, 95, "", 1014, 1, "#Controle::OnTotem3Death";
	end;

OnTotem4Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@Totemdono[4] != @loop) announce "O Pilar de Câncer foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@Totemdono[4] != @loop) set $@Totemdono[4], @loop;
	monster "002.gat", 93, 90, "", 1014, 1, "#Controle::OnTotem4Death";
	end;

OnTotem5Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@Totemdono[5] != @loop) announce "O Pilar de Leão foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@Totemdono[5] != @loop) set $@Totemdono[5], @loop;
	monster "002.gat", 93, 85, "", 1014, 1, "#Controle::OnTotem5Death";
	end;

OnTotem6Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@Totemdono[6] != @loop) announce "O Pilar de Virgem foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@Totemdono[6] != @loop) set $@Totemdono[6], @loop;
	monster "002.gat", 105, 105, "", 1014, 1, "#Controle::OnTotem6Death";
	end;

OnTotem7Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@Totemdono[7] != @loop) announce "O Pilar de Libra foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@Totemdono[7] != @loop) set $@Totemdono[7], @loop;
	monster "002.gat", 105, 100, "", 1014, 1, "#Controle::OnTotem7Death";
	end;

OnTotem8Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@Totemdono[8] != @loop) announce "O Pilar de Escorpião foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@Totemdono[8] != @loop) set $@Totemdono[8], @loop;
	monster "002.gat", 105, 95, "", 1014, 1, "#Controle::OnTotem8Death";
	end;

OnTotem9Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@Totemdono[9] != @loop) announce "O Pilar de Sagitário foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@Totemdono[9] != @loop) set $@Totemdono[9], @loop;
	monster "002.gat", 105, 90, "", 1014, 1, "#Controle::OnTotem9Death";
	end;

OnTotem10Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@Totemdono[10] != @loop) announce "O Pilar de Capricórnio foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@Totemdono[10] != @loop) set $@Totemdono[10], @loop;
	monster "002.gat", 105, 85, "", 1014, 1, "#Controle::OnTotem10Death";
	end;

OnTotem11Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@Totemdono[11] != @loop) announce "O Pilar de Aquário foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@Totemdono[11] != @loop) set $@Totemdono[11], @loop;
	monster "002.gat", 101, 85, "", 1014, 1, "#Controle::OnTotem11Death";
	end;

OnTotem12Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@Totemdono[12] != @loop) announce "O Pilar de Peixes foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@Totemdono[12] != @loop) set $@Totemdono[12], @loop;
	monster "002.gat", 97, 85, "", 1014, 1, "#Controle::OnTotem12Death";
	end;

L_Anuncios:
//	Valores apenas para teste
	if (gettime(1) >= 10 && gettime(1) <= 20 && $@Anuncios == 0) goto L_Anuncio1;
	if (gettime(1) >= 20 && gettime(1) <= 30 && $@Anuncios == 1) goto L_Anuncio2;
	if (gettime(1) >= 30 && gettime(1) <= 40 && $@Anuncios == 2) goto L_Anuncio3;
	if (gettime(1) >= 40 && gettime(1) <= 50 && $@Anuncios == 3) goto L_Anuncio4;
	if (gettime(1) >= 50 && gettime(1) <= 59 && $@Anuncios == 4) goto L_Anuncio5;
	if (gettime(1) >= 0 && gettime(1) <= 10 && $@Anuncios == 5) goto L_Anuncio6;
	end;

L_Anuncio1:
	announce "Os Pilares de Érnegon, que sustentam o Mundo de Mana desde tempos imemoriais, passaram a sofrer instabilidades devido ao alinhamento cósmico que envolvem as forças do universo. Autoridades mágicas estimam que tal período durará cerca de um milênio.", 0;
	set $@Anuncios, 1;
	end;

L_Anuncio2:
	announce "Desde eras mitólogicas os Pilares de Érnegon deste mundo estiveram invisíveis na região onde se encontra o Castelo Brhamir, garantindo o equilibrio necessário para nos resguardar de toda sorte de males.", 0;
	set $@Anuncios, 2;
	end;

L_Anuncio3:
	announce "Por conta desse período de trevas que estamos atrevessando, os Pilares de Érnegon estão enfraquecidos e visíveis no Jardim do Castelo, sofrendo nesse exato momento ataques de criaturas do submundo. O destino do Mundo de Mana depende desses pilares.", 0;
	set $@Anuncios, 3;
	end;

L_Anuncio4:
	announce "Tradicionalmente, os segredos desse mundo ficaram restrito às fadas do Reino de Lilith. Segundo Ivanize, reza a lenda que os Piláres de Érnegon devem ser distruídos por membros da mesma Família para serem estabilizados e renovados.", 0;
	set $@Anuncios, 4;
	end;

L_Anuncio5:
	announce "Os Alquimistas do Mundo de Mana uniram poderes para despertar o Mestre do Magos, Danboudor. Somente ele poderá fazer a habilitação mágica das Famílias para renovarem os Pilares de Érnegon. Ele estará por pouco tempo no portão do Castelo.", 0;
	set $@Anuncios, 5;
	end;

L_Anuncio6:
	announce "A batalha pela sobrevivência e perpetuação dos seres vivos deste mundo é trágica e violenta... Apenas as melhores famílias poderão garantir a vida no Mundo de Mana! Ao ataque cavaleiros e amazonas!!! Danboudor vos espera no portão do castelo!", 0;
	set $@Anuncios, 0;
	goto L_Iniciar;

L_Checar_Tempo:
	if (gettimetick(2) - $@EVENTO_INICIO > 60) goto L_Fim_Evento;
	end;

OnPCKilledEvent:
	if ($@EVENTO_STATUS != 1) end;
	attachrid(@killerrid);
	if (controledeeventos == $CONTROLE_EVENTOS && $CONTROLE_EVENTOS != 0 && grupoexistente != 0) goto L_Matou;
	end;

L_Matou:
	announce strcharinfo(0) + " derrotou um inimigo no campo ", 0;
	message strcharinfo(0), "Aê! Você derrotou alguém!";
	percentheal -100, 0;
	set mortes_evento_totem, mortes_evento_totem + 1;
	set $@MORTES_EVENTO_TOTEM[grupoexistente], $@MORTES_EVENTO_TOTEM[grupoexistente] + 1;
	end;

L_Fim_Evento:
	set $@loop, 0;
	callsub S_CONTAGEM;
	set $@loop, 0;
	set $@VENCEDOR, 0;
	set $@VENCEDOR_TOTENS, 0;
	set $@VENCEDOR_MORTES, 0;
	callsub S_COMPARA;
	callsub S_REPETIDOS;
	callsub S_DESEMPATE;
	set $@loop, 0;
	callsub S_DESEMPATE_REPETIDOS;
	if ($@VENCEDOR_TOTENS != 0 && getarraysize($@EMPATADOS) == 1) announce "A família " + $@GRUPOS_AUTOEVENTO$[$@VENCEDOR] + " capturou " + $@VENCEDOR_TOTENS + " Totens e ganhou o evento!", 0;
	if ($@VENCEDOR_TOTENS == 0) announce "Nenhum totem foi derrubado. Ninguém ganhou. :D", 0;
	if ($@VENCEDOR_TOTENS != 0 && getarraysize($@EMPATADOS) != 1) goto L_Anuncia_Empate_Simples;
	goto L_Limpar;

L_Anuncia_Empate_Simples:
	if (getarraysize($@EMPATADOS_MORTES) != 1 && $@VENCEDOR_MORTES != 0)  goto L_Anuncia_Empate_Mortes;
	if (getarraysize($@EMPATADOS_MORTES) == 1 && $@VENCEDOR_MORTES != 0)  goto L_Anuncia_Vencedor_Mortes;
	announce "Os vencedores foram as seguintes famílias, que derrubaram " + $@VENCEDOR_TOTENS + " totens cada uma: ", 0;
	announce "Família " + $@GRUPOS_AUTOEVENTO$[$@VENCEDOR], 0;
	if ($@EMPATADOS[1] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[1], 0;
	if ($@EMPATADOS[2] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[2], 0;
	if ($@EMPATADOS[3] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[3], 0;
	if ($@EMPATADOS[4] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[4], 0;
	if ($@EMPATADOS[5] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[5], 0;
	if ($@EMPATADOS[6] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[6], 0;
	if ($@EMPATADOS[7] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[7], 0;
	if ($@EMPATADOS[8] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[8], 0;
	if ($@EMPATADOS[9] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[9], 0;
	if ($@EMPATADOS[10] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[10], 0;
	if ($@EMPATADOS[11] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[11], 0;
	if ($@EMPATADOS[12] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[12], 0;
	goto L_Limpar;

L_Anuncia_Empate_Mortes:
	announce "Os vencedores foram as seguintes famílias, que derrubaram " + $@VENCEDOR_TOTENS + " totens e derrotaram " + $@VENCEDOR_MORTES + " inimigos cada uma: ", 0;
	if ($@MORTES_EVENTO_TOTEM[1] == $@VENCEDOR_MORTES && $@GRUPO1_TOTENS == $@VENCEDOR_TOTENS) announce "Família " + $@GRUPOS_AUTOEVENTO$[1], 0;
	if ($@MORTES_EVENTO_TOTEM[2] == $@VENCEDOR_MORTES && $@GRUPO2_TOTENS == $@VENCEDOR_TOTENS) announce "Família " + $@GRUPOS_AUTOEVENTO$[2], 0;
	if ($@MORTES_EVENTO_TOTEM[3] == $@VENCEDOR_MORTES && $@GRUPO3_TOTENS == $@VENCEDOR_TOTENS) announce "Família " + $@GRUPOS_AUTOEVENTO$[3], 0;
	if ($@MORTES_EVENTO_TOTEM[4] == $@VENCEDOR_MORTES && $@GRUPO4_TOTENS == $@VENCEDOR_TOTENS) announce "Família " + $@GRUPOS_AUTOEVENTO$[4], 0;
	if ($@MORTES_EVENTO_TOTEM[5] == $@VENCEDOR_MORTES && $@GRUPO5_TOTENS == $@VENCEDOR_TOTENS) announce "Família " + $@GRUPOS_AUTOEVENTO$[5], 0;
	if ($@MORTES_EVENTO_TOTEM[6] == $@VENCEDOR_MORTES && $@GRUPO6_TOTENS == $@VENCEDOR_TOTENS) announce "Família " + $@GRUPOS_AUTOEVENTO$[6], 0;
	if ($@MORTES_EVENTO_TOTEM[7] == $@VENCEDOR_MORTES && $@GRUPO7_TOTENS == $@VENCEDOR_TOTENS) announce "Família " + $@GRUPOS_AUTOEVENTO$[7], 0;
	if ($@MORTES_EVENTO_TOTEM[8] == $@VENCEDOR_MORTES && $@GRUPO8_TOTENS == $@VENCEDOR_TOTENS) announce "Família " + $@GRUPOS_AUTOEVENTO$[8], 0;
	if ($@MORTES_EVENTO_TOTEM[9] == $@VENCEDOR_MORTES && $@GRUPO9_TOTENS == $@VENCEDOR_TOTENS) announce "Família " + $@GRUPOS_AUTOEVENTO$[9], 0;
	if ($@MORTES_EVENTO_TOTEM[10] == $@VENCEDOR_MORTES && $@GRUPO10_TOTENS == $@VENCEDOR_TOTENS) announce "Família " + $@GRUPOS_AUTOEVENTO$[10], 0;
	if ($@MORTES_EVENTO_TOTEM[11] == $@VENCEDOR_MORTES && $@GRUPO11_TOTENS == $@VENCEDOR_TOTENS) announce "Família " + $@GRUPOS_AUTOEVENTO$[11], 0;
	if ($@MORTES_EVENTO_TOTEM[12] == $@VENCEDOR_MORTES && $@GRUPO11_TOTENS == $@VENCEDOR_TOTENS) announce "Família " + $@GRUPOS_AUTOEVENTO$[12], 0;
	goto L_Limpar;

L_Anuncia_Vencedor_Mortes:
	announce "A família " + $@GRUPOS_AUTOEVENTO$[$@VENCEDOR_MORTES] + " capturou " + $@VENCEDOR_TOTENS + " Totens e derrotou " + $@VENCEDOR_MORTES + " inimigos, o que faz dela a vencedora do evento.", 0;
	goto L_Limpar;

S_QUALGRUPO:
	set @loop, @loop + 1;
	if ($@GRUPOS_AUTOEVENTO$[@loop] == getpartyname(getcharid(1))) return;
	if (@loop > 12) message strcharinfo(0), "nao achei seu grupo!";
	if (@loop > 12) return;
	goto S_QUALGRUPO;

S_CONTAGEM:
	set $@loop, $@loop + 1;
	if ($@loop > 12) return;
	if ($@Totemdono[$@loop] == 1) set $@GRUPO1_TOTENS, $@GRUPO1_TOTENS + 1;
	if ($@Totemdono[$@loop] == 2) set $@GRUPO2_TOTENS, $@GRUPO2_TOTENS + 1;
	if ($@Totemdono[$@loop] == 3) set $@GRUPO3_TOTENS, $@GRUPO3_TOTENS + 1;
	if ($@Totemdono[$@loop] == 4) set $@GRUPO4_TOTENS, $@GRUPO4_TOTENS + 1;
	if ($@Totemdono[$@loop] == 5) set $@GRUPO5_TOTENS, $@GRUPO5_TOTENS + 1;
	if ($@Totemdono[$@loop] == 6) set $@GRUPO6_TOTENS, $@GRUPO6_TOTENS + 1;
	if ($@Totemdono[$@loop] == 7) set $@GRUPO7_TOTENS, $@GRUPO7_TOTENS + 1;
	if ($@Totemdono[$@loop] == 8) set $@GRUPO8_TOTENS, $@GRUPO8_TOTENS + 1;
	if ($@Totemdono[$@loop] == 9) set $@GRUPO9_TOTENS, $@GRUPO9_TOTENS + 1;
	if ($@Totemdono[$@loop] == 10) set $@GRUPO10_TOTENS, $@GRUPO10_TOTENS + 1;
	if ($@Totemdono[$@loop] == 11) set $@GRUPO11_TOTENS, $@GRUPO11_TOTENS + 1;
	if ($@Totemdono[$@loop] == 12) set $@GRUPO12_TOTENS, $@GRUPO12_TOTENS + 1;
	goto S_CONTAGEM;

S_COMPARA:
	if ($@GRUPO1_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR,1;
	if ($@GRUPO1_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR_TOTENS, $@GRUPO1_TOTENS;
	if ($@GRUPO2_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR,2;
	if ($@GRUPO2_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR_TOTENS, $@GRUPO2_TOTENS;
	if ($@GRUPO3_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR,3;
	if ($@GRUPO3_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR_TOTENS, $@GRUPO3_TOTENS;
	if ($@GRUPO4_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR,4;
	if ($@GRUPO4_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR_TOTENS, $@GRUPO4_TOTENS;
	if ($@GRUPO5_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR,5;
	if ($@GRUPO5_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR_TOTENS, $@GRUPO5_TOTENS;
	if ($@GRUPO6_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR,6;
	if ($@GRUPO6_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR_TOTENS, $@GRUPO6_TOTENS;
	if ($@GRUPO7_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR,7;
	if ($@GRUPO7_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR_TOTENS, $@GRUPO7_TOTENS;
	if ($@GRUPO8_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR,8;
	if ($@GRUPO8_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR_TOTENS, $@GRUPO8_TOTENS;
	if ($@GRUPO9_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR,9;
	if ($@GRUPO9_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR_TOTENS, $@GRUPO9_TOTENS;
	if ($@GRUPO10_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR,10;
	if ($@GRUPO10_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR_TOTENS, $@GRUPO10_TOTENS;
	if ($@GRUPO11_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR,11;
	if ($@GRUPO11_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR_TOTENS, $@GRUPO11_TOTENS;
	if ($@GRUPO12_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR,12;
	if ($@GRUPO12_TOTENS > $@VENCEDOR_TOTENS) set $@VENCEDOR_TOTENS, $@GRUPO12_TOTENS;
	return;

S_REPETIDOS:
	if ($@VENCEDOR_TOTENS == 0) return;
	if ($@VENCEDOR != 1 && $@GRUPO1_TOTENS == $@VENCEDOR_TOTENS) set $@EMPATADOS[1], 1;
	if ($@VENCEDOR != 2 && $@GRUPO2_TOTENS == $@VENCEDOR_TOTENS) set $@EMPATADOS[2], 2;
	if ($@VENCEDOR != 3 && $@GRUPO3_TOTENS == $@VENCEDOR_TOTENS) set $@EMPATADOS[3], 3;
	if ($@VENCEDOR != 4 && $@GRUPO4_TOTENS == $@VENCEDOR_TOTENS) set $@EMPATADOS[4], 4;
	if ($@VENCEDOR != 5 && $@GRUPO5_TOTENS == $@VENCEDOR_TOTENS) set $@EMPATADOS[5], 5;
	if ($@VENCEDOR != 6 && $@GRUPO6_TOTENS == $@VENCEDOR_TOTENS) set $@EMPATADOS[6], 6;
	if ($@VENCEDOR != 7 && $@GRUPO7_TOTENS == $@VENCEDOR_TOTENS) set $@EMPATADOS[7], 7;
	if ($@VENCEDOR != 8 && $@GRUPO8_TOTENS == $@VENCEDOR_TOTENS) set $@EMPATADOS[8], 8;
	if ($@VENCEDOR != 9 && $@GRUPO9_TOTENS == $@VENCEDOR_TOTENS) set $@EMPATADOS[9], 9;
	if ($@VENCEDOR != 10 && $@GRUPO10_TOTENS == $@VENCEDOR_TOTENS) set $@EMPATADOS[10], 10;
	if ($@VENCEDOR != 11 && $@GRUPO11_TOTENS == $@VENCEDOR_TOTENS) set $@EMPATADOS[11], 11;
	if ($@VENCEDOR != 12 && $@GRUPO12_TOTENS == $@VENCEDOR_TOTENS) set $@EMPATADOS[12], 12;
	return;

S_DESEMPATE:
	if (getarraysize($@EMPATADOS) == 1) return;
	if ($@MORTES_EVENTO_TOTEM[1] > $@VENCEDOR_MORTES && $@EMPATADOS[1] != 0) set $@VENCEDOR_MORTES_GRUPO, 1;
	if ($@MORTES_EVENTO_TOTEM[1] > $@VENCEDOR_MORTES && $@EMPATADOS[1] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_TOTEM[1];
	if ($@MORTES_EVENTO_TOTEM[2] > $@VENCEDOR_MORTES && $@EMPATADOS[2] != 0) set $@VENCEDOR_MORTES_GRUPO, 2;
	if ($@MORTES_EVENTO_TOTEM[2] > $@VENCEDOR_MORTES && $@EMPATADOS[2] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_TOTEM[2];
	if ($@MORTES_EVENTO_TOTEM[3] > $@VENCEDOR_MORTES && $@EMPATADOS[3] != 0) set $@VENCEDOR_MORTES_GRUPO, 3;
	if ($@MORTES_EVENTO_TOTEM[3] > $@VENCEDOR_MORTES && $@EMPATADOS[3] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_TOTEM[3];
	if ($@MORTES_EVENTO_TOTEM[4] > $@VENCEDOR_MORTES && $@EMPATADOS[4] != 0) set $@VENCEDOR_MORTES_GRUPO, 4;
	if ($@MORTES_EVENTO_TOTEM[4] > $@VENCEDOR_MORTES && $@EMPATADOS[4] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_TOTEM[4];
	if ($@MORTES_EVENTO_TOTEM[5] > $@VENCEDOR_MORTES && $@EMPATADOS[5] != 0) set $@VENCEDOR_MORTES_GRUPO, 5;
	if ($@MORTES_EVENTO_TOTEM[5] > $@VENCEDOR_MORTES && $@EMPATADOS[5] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_TOTEM[5];
	if ($@MORTES_EVENTO_TOTEM[6] > $@VENCEDOR_MORTES && $@EMPATADOS[6] != 0) set $@VENCEDOR_MORTES_GRUPO, 6;
	if ($@MORTES_EVENTO_TOTEM[6] > $@VENCEDOR_MORTES && $@EMPATADOS[6] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_TOTEM[6];
	if ($@MORTES_EVENTO_TOTEM[7] > $@VENCEDOR_MORTES && $@EMPATADOS[7] != 0) set $@VENCEDOR_MORTES_GRUPO, 7;
	if ($@MORTES_EVENTO_TOTEM[7] > $@VENCEDOR_MORTES && $@EMPATADOS[7] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_TOTEM[7];
	if ($@MORTES_EVENTO_TOTEM[8] > $@VENCEDOR_MORTES && $@EMPATADOS[8] != 0) set $@VENCEDOR_MORTES_GRUPO, 8;
	if ($@MORTES_EVENTO_TOTEM[8] > $@VENCEDOR_MORTES && $@EMPATADOS[8] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_TOTEM[8];
	if ($@MORTES_EVENTO_TOTEM[9] > $@VENCEDOR_MORTES && $@EMPATADOS[9] != 0) set $@VENCEDOR_MORTES_GRUPO, 9;
	if ($@MORTES_EVENTO_TOTEM[9] > $@VENCEDOR_MORTES && $@EMPATADOS[9] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_TOTEM[9];
	if ($@MORTES_EVENTO_TOTEM[10] > $@VENCEDOR_MORTES && $@EMPATADOS[10] != 0) set $@VENCEDOR_MORTES_GRUPO, 10;
	if ($@MORTES_EVENTO_TOTEM[10] > $@VENCEDOR_MORTES && $@EMPATADOS[10] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_TOTEM[10];
	if ($@MORTES_EVENTO_TOTEM[11] > $@VENCEDOR_MORTES && $@EMPATADOS[11] != 0) set $@VENCEDOR_MORTES_GRUPO, 11;
	if ($@MORTES_EVENTO_TOTEM[11] > $@VENCEDOR_MORTES && $@EMPATADOS[11] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_TOTEM[11];
	if ($@MORTES_EVENTO_TOTEM[12] > $@VENCEDOR_MORTES && $@EMPATADOS[12] != 0) set $@VENCEDOR_MORTES_GRUPO, 12;
	if ($@MORTES_EVENTO_TOTEM[12] > $@VENCEDOR_MORTES && $@EMPATADOS[12] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_TOTEM[12];
	return;

S_DESEMPATE_REPETIDOS:
	if ($@VENCEDOR_MORTES == 0) return;
	if ($@VENCEDOR_MORTES_GRUPO != 1 && $@MORTES_EVENTO_TOTEM[1] == $@VENCEDOR_MORTES) set $@EMPATADOS_MORTES[1], 1;
	if ($@VENCEDOR_MORTES_GRUPO != 2 && $@MORTES_EVENTO_TOTEM[2] == $@VENCEDOR_MORTES) set $@EMPATADOS_MORTES[2], 2;
	if ($@VENCEDOR_MORTES_GRUPO != 3 && $@MORTES_EVENTO_TOTEM[3] == $@VENCEDOR_MORTES) set $@EMPATADOS_MORTES[3], 3;
	if ($@VENCEDOR_MORTES_GRUPO != 4 && $@MORTES_EVENTO_TOTEM[4] == $@VENCEDOR_MORTES) set $@EMPATADOS_MORTES[4], 4;
	if ($@VENCEDOR_MORTES_GRUPO != 5 && $@MORTES_EVENTO_TOTEM[5] == $@VENCEDOR_MORTES) set $@EMPATADOS_MORTES[5], 5;
	if ($@VENCEDOR_MORTES_GRUPO != 6 && $@MORTES_EVENTO_TOTEM[6] == $@VENCEDOR_MORTES) set $@EMPATADOS_MORTES[6], 6;
	if ($@VENCEDOR_MORTES_GRUPO != 7 && $@MORTES_EVENTO_TOTEM[7] == $@VENCEDOR_MORTES) set $@EMPATADOS_MORTES[7], 7;
	if ($@VENCEDOR_MORTES_GRUPO != 8 && $@MORTES_EVENTO_TOTEM[8] == $@VENCEDOR_MORTES) set $@EMPATADOS_MORTES[8], 8;
	if ($@VENCEDOR_MORTES_GRUPO != 9 && $@MORTES_EVENTO_TOTEM[9] == $@VENCEDOR_MORTES) set $@EMPATADOS_MORTES[9], 9;
	if ($@VENCEDOR_MORTES_GRUPO != 10 && $@MORTES_EVENTO_TOTEM[10] == $@VENCEDOR_MORTES) set $@EMPATADOS_MORTES[10], 10;
	if ($@VENCEDOR_MORTES_GRUPO != 11 && $@MORTES_EVENTO_TOTEM[11] == $@VENCEDOR_MORTES) set $@EMPATADOS_MORTES[11], 11;
	if ($@VENCEDOR_MORTES_GRUPO != 12 && $@MORTES_EVENTO_TOTEM[12] == $@VENCEDOR_MORTES) set $@EMPATADOS_MORTES[12], 12;
	return;

L_Limpar:
	set $@EVENTO_STATUS, 0;
	set $@EVENTO_DEBUG, 0;
	set $@EVENTO_INICIO, 0;
	cleararray $@GRUPOS_AUTOEVENTO$[0], "", 13;
	cleararray $@GRUPO1$[0], "", 13;
	cleararray $@GRUPO2$[0], "", 13;
	cleararray $@GRUPO3$[0], "", 13;
	cleararray $@GRUPO4$[0], "", 13;
	cleararray $@GRUPO5$[0], "", 13;
	cleararray $@GRUPO6$[0], "", 13;
	cleararray $@GRUPO7$[0], "", 13;
	cleararray $@GRUPO8$[0], "", 13;
	cleararray $@GRUPO9$[0], "", 13;
	cleararray $@GRUPO10$[0], "", 13;
	cleararray $@GRUPO11$[0], "", 13;
	cleararray $@GRUPO12$[0], "", 13;
	cleararray $@MORTES_EVENTO_TOTEM[0], 0, 13;
	set $@GRUPO1_TOTENS, 0;
	set $@GRUPO2_TOTENS, 0;
	set $@GRUPO3_TOTENS, 0;
	set $@GRUPO4_TOTENS, 0;
	set $@GRUPO5_TOTENS, 0;
	set $@GRUPO6_TOTENS, 0;
	set $@GRUPO7_TOTENS, 0;
	set $@GRUPO8_TOTENS, 0;
	set $@GRUPO9_TOTENS, 0;
	set $@GRUPO10_TOTENS, 0;
	cleararray $@Totemdono[0], 0, 13;
	set $@DISABLEDAN, 1;
	killmonster "002.gat", "#Controle::OnTotem1Death";
	killmonster "002.gat", "#Controle::OnTotem2Death";
	killmonster "002.gat", "#Controle::OnTotem3Death";
	killmonster "002.gat", "#Controle::OnTotem4Death";
	killmonster "002.gat", "#Controle::OnTotem5Death";
	killmonster "002.gat", "#Controle::OnTotem6Death";
	killmonster "002.gat", "#Controle::OnTotem7Death";
	killmonster "002.gat", "#Controle::OnTotem8Death";
	killmonster "002.gat", "#Controle::OnTotem9Death";
	killmonster "002.gat", "#Controle::OnTotem10Death";
	killmonster "002.gat", "#Controle::OnTotem11Death";
	killmonster "002.gat", "#Controle::OnTotem12Death";
	end;

onInit:
	disablenpc "Danboudor";
	initnpctimer;
	end;

}
