//   $Porta da PB(Pensão Bhramir)


005-2.gat,24,27,0	script	#Saida 001	300,0,0,{
	set @Quarto, 1;
	set @SaidaX, 71;
	set @SaidaY, 51;
	callfunc "SaidaHB";
}
//--------------------------------------------------------------------------------------------------------
005-2.gat,54,27,0	script	#Saida 002	300,0,0,{
	set @Quarto, 2;
	set @SaidaX, 73;
	set @SaidaY, 51;
	callfunc "SaidaHB";
}
//--------------------------------------------------------------------------------------------------------

005-2.gat,84,27,0	script	#Saida 003	300,0,0,{
	set @Quarto, 3; 
	set @SaidaX, 75; 
	set @SaidaY, 51; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,114,27,0	script	#Saida 004	300,0,0,{
	set @Quarto, 4; 
	set @SaidaX, 77; 
	set @SaidaY, 51; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,144,27,0	script	#Saida 005	300,0,0,{
	set @Quarto, 5; 
	set @SaidaX, 79; 
	set @SaidaY, 51; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,174,19,0	script	#Saida 006	300,0,0,{
	set @Quarto, 6; 
	set @SaidaX, 71; 
	set @SaidaY, 52; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,24,51,0	script	#Saida 007	300,0,0,{
	set @Quarto, 7; 
	set @SaidaX, 73; 
	set @SaidaY, 52; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,54,51,0	script	#Saida 008	300,0,0,{
	set @Quarto, 8; 
	set @SaidaX, 75; 
	set @SaidaY, 52; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,84,51,0	script	#Saida 009	300,0,0,{
	set @Quarto, 9; 
	set @SaidaX, 77; 
	set @SaidaY, 52; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,114,51,0	script	#Saida 010	300,0,0,{
	set @Quarto, 10; 
	set @SaidaX, 79; 
	set @SaidaY, 52; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,144,59,0	script	#Saida 011	300,0,0,{
	set @Quarto, 11; 
	set @SaidaX, 71; 
	set @SaidaY, 81; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,174,59,0	script	#Saida 012	300,0,0,{
	set @Quarto, 12; 
	set @SaidaX, 73; 
	set @SaidaY, 81; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,24,91,0	script	#Saida 013	300,0,0,{
	set @Quarto, 13; 
	set @SaidaX, 75; 
	set @SaidaY, 81; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,54,91,0	script	#Saida 014	300,0,0,{
	set @Quarto, 14; 
	set @SaidaX, 77; 
	set @SaidaY, 81; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,84,91,0	script	#Saida 015	300,0,0,{
	set @Quarto, 15; 
	set @SaidaX, 79; 
	set @SaidaY, 81; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,114,83,0	script	#Saida 016	300,0,0,{
	set @Quarto, 16; 
	set @SaidaX, 71; 
	set @SaidaY, 82; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,144,83,0	script	#Saida 017	300,0,0,{
	set @Quarto, 17; 
	set @SaidaX, 73; 
	set @SaidaY, 82; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,174,83,0	script	#Saida 018	300,0,0,{
	set @Quarto, 18; 
	set @SaidaX, 75; 
	set @SaidaY, 82; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,24,116,0	script	#Saida 019	300,0,0,{
	set @Quarto, 19; 
	set @SaidaX, 77; 
	set @SaidaY, 82; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,54,115,0	script	#Saida 020	300,0,0,{
	set @Quarto, 20; 
	set @SaidaX, 79; 
	set @SaidaY, 82; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,84,123,0	script	#Saida 021	300,0,0,{
	set @Quarto, 21; 
	set @SaidaX, 22; 
	set @SaidaY, 83; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,114,123,0	script	#Saida 022	300,0,0,{
	set @Quarto, 22; 
	set @SaidaX, 24; 
	set @SaidaY, 83; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,144,123,0	script	#Saida 023	300,0,0,{
	set @Quarto, 23; 
	set @SaidaX, 26; 
	set @SaidaY, 83; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,174,123,0	script	#Saida 024	300,0,0,{
	set @Quarto, 24; 
	set @SaidaX, 28; 
	set @SaidaY, 83; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,24,155,0	script	#Saida 025	300,0,0,{
	set @Quarto, 25; 
	set @SaidaX, 30; 
	set @SaidaY, 83; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,54,146,0	script	#Saida 026	300,0,0,{
	set @Quarto, 26; 
	set @SaidaX, 22; 
	set @SaidaY, 84; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,84,147,0	script	#Saida 027	300,0,0,{
	set @Quarto, 27; 
	set @SaidaX, 24; 
	set @SaidaY, 84; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,114,147,0	script	#Saida 028	300,0,0,{
	set @Quarto, 28; 
	set @SaidaX, 26; 
	set @SaidaY, 84; 
	callfunc "SaidaHB";
}

//--------------------------------------------------------------------------------------------------------

005-2.gat,144,147,0	script	#Saida 029	300,0,0,{
	set @Quarto, 29; 
	set @SaidaX, 28; 
	set @SaidaY, 84; 
	callfunc "SaidaHB";
}

//###################################################################################################################


function	script	SaidaHB	{
	if(@Quarto>=1 && @SaidaX>=1 && @SaidaY>=1) goto _opcoes;
	mes "[ERRO]";
	if(@Quarto==0) mes "Declare [@Quarto > 0]";
	if(@SaidaX==0) mes "Declare [@SaidaX > 0]";
	if(@SaidaY==0) mes "Declare [@SaidaY > 0]";
	close;
//--------------------------------------------------------------------------------------------------------
_opcoes:
	if($PB_Senha$[@Quarto]!="") set @Funcao$, "Substituir senha";
	if($PB_Senha$[@Quarto]=="") set @Funcao$, "Proteger com senha";
	mes "["+ strcharinfo(0) +"]";
	mes "O QUE QUERO FAZER?";
	menu
		"Vou Sair", _sair,
		@Funcao$, _requisita_senha,
		"Nada!", _nada;
	goto _sair;

_sair:
	set @resta, $PB_Vencimentos[@Quarto] - gettimetick(2);
	set @dias, @resta/86400;
	set @horas, (@resta - (@dias*86400))/3600;
	set @minutos, (@resta - (@dias*86400) - (@horas*3600))/60;
	set @segundos, (@resta - (@dias*86400) - (@horas*3600) - (@minutos*60));
	warp "005-3.gat", @SaidaX, @SaidaY;
	if($PB_Inquilinos$[@Quarto]==strcharinfo(0)) mes "["+ strcharinfo(0) +"]";
	if($PB_Inquilinos$[@Quarto]==strcharinfo(0)) mes "Ainda me faltam "+@dias+" dias, "+@horas+" horas, "+@minutos+" minutos e "+@segundos+" segundos.";
	close;

_requisita_senha:
	if(
		$PB_Senha$[@Quarto] == "!!ERROR!!" || 
		$PB_Senha$[@Quarto] == "" || 
		$PB_Inquilinos$[@Quarto]==strcharinfo(0)
	) goto _trocar_senha;

	mes "[PENSÃO BHRAMIR - Nº"+ @Quarto +"]:";
	mes "DIGITE SUA SENHA ATUAL:";
	input @Senha$;
	if(@Senha$ == $PB_Senha$[@Quarto]) goto _trocar_senha;
	if(@Senha$ == "") goto _opcoes;
	if(@Senha$ != $PB_Senha$[@Quarto]) goto _senha_invalida;
	close;

_trocar_senha:
	mes "[AVISO]";
	mes "Digite sua nova senha:";
	input @Senha$;
	set $PB_Senha$[@Quarto], @Senha$;
	if(@Senha$ == "") goto _destrancar_senha;
	mes "Repita sua nova senha para confirmar:";
	input @Confirmacao$;
	if(@Senha$ != @Confirmacao$) goto _confirmacao_invalida;

	set $PB_Senha$[@Quarto], @Senha$;
	if(@Senha$ == "") goto _destrancar_senha;
	mes "[AVISO]";
	mes "Senha gravada com sucesso!";
	next;
	goto _opcoes;

_confirmacao_invalida:
	mes "[AVISO]";
	mes "Sua nova senha não confirmada!";
	next;
	goto _trocar_senha;

_destrancar_senha:
	mes "[AVISO]";
	mes "Porta destrancada!";
	next;
	goto _opcoes;

_senha_invalida:
	mes "[AVISO]";
	mes "Senha atual inválida!";
	next;
	goto _requisita_senha;

_nada:
	close;

}
