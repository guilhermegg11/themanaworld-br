// NPC Danboudor

005.gat,100,23,0	script	Danboudor	328,{

	if ($@EVENTO_STATUS == 1 && controledeeventos != $CONTROLE_EVENTOS) goto L_Evento;
	if ($@EVENTO_STATUS == 1 && controledeeventos == $CONTROLE_EVENTOS) goto L_Voltar;
	if ((controledeeventos == $CONTROLE_EVENTOS && $CONTROLE_EVENTOS != 0) && (grupoexistente == $VENCEDOR_GRUPO || 	grupoexistente == $EMPATADOS[1] || grupoexistente == $EMPATADOS[2] || grupoexistente == $EMPATADOS[3] || grupoexistente == $EMPATADOS[4] || grupoexistente == $EMPATADOS[5] || grupoexistente == $EMPATADOS[6] || grupoexistente == $EMPATADOS[7] || grupoexistente == $EMPATADOS[8] || grupoexistente == $EMPATADOS[9] || grupoexistente == $EMPATADOS[10] || grupoexistente == $EMPATADOS[11] || grupoexistente == $EMPATADOS[12] || grupoexistente == $VENCEDOR_MORTES_GRUPO || grupoexistente == $EMPATADOS_MORTES[1] || grupoexistente == $EMPATADOS_MORTES[2] || grupoexistente == $EMPATADOS_MORTES[3] || grupoexistente == $EMPATADOS_MORTES[4] || grupoexistente == $EMPATADOS_MORTES[5] || grupoexistente == $EMPATADOS_MORTES[6] || grupoexistente == $EMPATADOS_MORTES[7] || grupoexistente == $EMPATADOS_MORTES[8] || grupoexistente == $EMPATADOS_MORTES[9] || grupoexistente == $EMPATADOS_MORTES[10] || grupoexistente == $EMPATADOS_MORTES[11] || grupoexistente == $EMPATADOS_MORTES[12])) goto L_Premio;

	mes "[Danboudor]";
	mes "\"Você NÃO faz parte do grupo vencedor do evento número " + $CONTROLE_EVENTOS + ".\"";
	close;

L_Premio:
	mes "[Danboudor]";
	mes "\"Você faz parte do grupo vencedor do evento número " + $CONTROLE_EVENTOS + ".\"";
	close;

L_Voltar:
	set grupoexistente, 0;
	set controledeeventos, 0;
	mes "[Danboudor]";
	mes "\"Você não deveria estar lá dentro? Quer que eu te mande de volta?\"";
	menu
		"Sim.", L_Entrada,
		"Não.", -;
	close;

L_Evento:
	mes "[" + strcharinfo(0) + "]";
	menu
		"Poderoso Danboudor, o que devo fazer?", -;

	mes "[Danboudor]";
	mes "\"Meu filho, você e sua Família (clã) devem atacar e dominar o maior número de Pilares de Érnegon.\"";
	next;

	mes "[" + strcharinfo(0) + "]";
	menu
		"Como fazemos isso Mestre dos Mestres?", -;

	mes "[Danboudor]";
	mes "\" Vocês devem atacar os Pilares de Érnegon até que eles sejam derrubados e se tornem propriedades de sua família.\"";
	next;
	mes "\"Quando o Pilar passar a ser da sua família, você deve protegê-lo para que não seja atacado por membros de outras famílias.\"";
	next;

	mes "[" + strcharinfo(0) + "]";
	menu
		"Hum... Compreendi. E depois?", -;

	mes "[Danboudor]";
	mes "\"Vocês devem preservar o maior número de pilares possível até que a batalha seja completada. Você vai batalhar?\"";
	next;

	mes "[" + strcharinfo(0) + "]";
	menu
		"Com certeza, defenderei a minha terra com meus amigos.", -,
		"Tenho medo, parece muito arriscado.", L_Fechar;

	mes "[Danboudor]";
	mes "\"Irei enfeitiça-lo e depois teletransportá-lo. Alohomora! Carpe Retractum!!!\"";
	next;
	if ($@EVENTO_STATUS != 1) close;
	if (getcharid(1) == 0) goto L_Sem_Grupo;
	set grupoexistente, 0;
	set @loop, 0;
	callsub S_PROCURA_GRUPO;
	set @loop, 0;
	callsub S_REGISTRA_GRUPO;
	set @loop, 0;
	callsub S_APRESENTA_GRUPOS;
	set @loop, 0;
	set controledeeventos, $CONTROLE_EVENTOS;
	goto L_Entrada;
	close;
	
L_Fechar:
	close;

L_Sem_Grupo:
	mes "[Danboudor]";
	mes "Você não faz parte de uma família. Se você entrar, infelizmente não vai poder ajudar em nada.";
	close;

L_Muitos_Grupos:
	set @loop, 0;
	mes "[Danboudor]";
	mes "Já existem muitos grupos trabalhando para derrubar os pilares de Érnegon.";
	return;

S_PROCURA_GRUPO:
	set @loop, @loop + 1;
	if ($@GRUPOS_AUTOEVENTO$[@loop] == getpartyname(getcharid(1))) set grupoexistente, @loop;
	if (@loop > 12) return;
	goto S_PROCURA_GRUPO;

S_REGISTRA_GRUPO:
	if (grupoexistente != 0) return;
	set @loop, @loop + 1;
	if ($@GRUPOS_AUTOEVENTO$[@loop] == "") set grupoexistente, @loop;
	if ($@GRUPOS_AUTOEVENTO$[@loop] == "") set $@GRUPOS_AUTOEVENTO$[@loop], getpartyname(getcharid(1));
	if (grupoexistente != 0) return;
	if (@loop > 12) goto L_Muitos_Grupos;
	goto S_REGISTRA_GRUPO;

S_APRESENTA_GRUPOS:
	if (grupoexistente == 1) goto GRUPO1;
	if (grupoexistente == 2) goto GRUPO2;
	if (grupoexistente == 3) goto GRUPO3;
	if (grupoexistente == 4) goto GRUPO4;
	if (grupoexistente == 5) goto GRUPO5;
	if (grupoexistente == 6) goto GRUPO6;
	if (grupoexistente == 7) goto GRUPO7;
	if (grupoexistente == 8) goto GRUPO8;
	if (grupoexistente == 9) goto GRUPO9;
	if (grupoexistente == 10) goto GRUPO10;
	if (grupoexistente == 11) goto GRUPO11;
	if (grupoexistente == 12) goto GRUPO12;

GRUPO1:
	set @loop, @loop + 1;
	if ($@GRUPO1$[@loop] != "" && $@GRUPO1$[@loop] != strcharinfo(0)) goto GRUPO1;
	if ($@GRUPO1$[@loop] == strcharinfo(0)) return;
	if ($@GRUPO1$[@loop] == "") set $@GRUPO1$[@loop], strcharinfo(0);
	if ($@GRUPO1$[@loop] == strcharinfo(0)) return;
	return;

GRUPO2:
	set @loop, @loop + 1;
	if ($@GRUPO2$[@loop] != "" && $@GRUPO2$[@loop] != strcharinfo(0)) goto GRUPO2;
	if ($@GRUPO2$[@loop] == strcharinfo(0)) return;
	if ($@GRUPO2$[@loop] == "") set $@GRUPO2$[@loop], strcharinfo(0);
	if ($@GRUPO2$[@loop] == strcharinfo(0)) return;
	return;

GRUPO3:
	set @loop, @loop + 1;
	if ($@GRUPO3$[@loop] != "" && $@GRUPO3$[@loop] != strcharinfo(0)) goto GRUPO3;
	if ($@GRUPO3$[@loop] == strcharinfo(0)) return;
	if ($@GRUPO3$[@loop] == "") set $@GRUPO3$[@loop], strcharinfo(0);
	if ($@GRUPO3$[@loop] == strcharinfo(0)) return;
	return;
	
GRUPO4:
	set @loop, @loop + 1;
	if ($@GRUPO4$[@loop] != "" && $@GRUPO4$[@loop] != strcharinfo(0)) goto GRUPO4;
	if ($@GRUPO4$[@loop] == strcharinfo(0)) return;
	if ($@GRUPO4$[@loop] == "") set $@GRUPO4$[@loop], strcharinfo(0);
	if ($@GRUPO4$[@loop] == strcharinfo(0)) return;
	return;
	
GRUPO5:
	set @loop, @loop + 1;
	if ($@GRUPO5$[@loop] != "" && $@GRUPO5$[@loop] != strcharinfo(0)) goto GRUPO5;
	if ($@GRUPO5$[@loop] == strcharinfo(0)) return;
	if ($@GRUPO5$[@loop] == "") set $@GRUPO5$[@loop], strcharinfo(0);
	if ($@GRUPO5$[@loop] == strcharinfo(0)) return;
	return;
	
GRUPO6:
	set @loop, @loop + 1;
	if ($@GRUPO6$[@loop] != "" && $@GRUPO6$[@loop] != strcharinfo(0)) goto GRUPO6;
	if ($@GRUPO6$[@loop] == strcharinfo(0)) return;
	if ($@GRUPO6$[@loop] == "") set $@GRUPO6$[@loop], strcharinfo(0);
	if ($@GRUPO6$[@loop] == strcharinfo(0)) return;
	return;

GRUPO7:
	set @loop, @loop + 1;
	if ($@GRUPO7$[@loop] != "" && $@GRUPO7$[@loop] != strcharinfo(0)) goto GRUPO7;
	if ($@GRUPO7$[@loop] == strcharinfo(0)) return;
	if ($@GRUPO7$[@loop] == "") set $@GRUPO7$[@loop], strcharinfo(0);
	if ($@GRUPO7$[@loop] == strcharinfo(0)) return;
	return;

GRUPO8:
	set @loop, @loop + 1;
	if ($@GRUPO8$[@loop] != "" && $@GRUPO8$[@loop] != strcharinfo(0)) goto GRUPO8;
	if ($@GRUPO8$[@loop] == strcharinfo(0)) return;
	if ($@GRUPO8$[@loop] == "") set $@GRUPO8$[@loop], strcharinfo(0);
	if ($@GRUPO8$[@loop] == strcharinfo(0)) return;
	return;

GRUPO9:
	set @loop, @loop + 1;
	if ($@GRUPO9$[@loop] != "" && $@GRUPO9$[@loop] != strcharinfo(0)) goto GRUPO9;
	if ($@GRUPO9$[@loop] == strcharinfo(0)) return;
	if ($@GRUPO9$[@loop] == "") set $@GRUPO9$[@loop], strcharinfo(0);
	if ($@GRUPO9$[@loop] == strcharinfo(0)) return;
	return;

GRUPO10:
	set @loop, @loop + 1;
	if ($@GRUPO10$[@loop] != "" && $@GRUPO10$[@loop] != strcharinfo(0)) goto GRUPO10;
	if ($@GRUPO10$[@loop] == strcharinfo(0)) return;
	if ($@GRUPO10$[@loop] == "") set $@GRUPO10$[@loop], strcharinfo(0);
	if ($@GRUPO10$[@loop] == strcharinfo(0)) return;
	return;

GRUPO11:
	set @loop, @loop + 1;
	if ($@GRUPO11$[@loop] != "" && $@GRUPO11$[@loop] != strcharinfo(0)) goto GRUPO11;
	if ($@GRUPO11$[@loop] == strcharinfo(0)) return;
	if ($@GRUPO11$[@loop] == "") set $@GRUPO11$[@loop], strcharinfo(0);
	if ($@GRUPO11$[@loop] == strcharinfo(0)) return;
	return;

GRUPO12:
	set @loop, @loop + 1;
	if ($@GRUPO12$[@loop] != "" && $@GRUPO12$[@loop] != strcharinfo(0)) goto GRUPO12;
	if ($@GRUPO12$[@loop] == strcharinfo(0)) return;
	if ($@GRUPO12$[@loop] == "") set $@GRUPO12$[@loop], strcharinfo(0);
	if ($@GRUPO12$[@loop] == strcharinfo(0)) return;
	return;

L_Entrada:
	warp "002.gat", 100, 118;
	close;
}

005.gat,103,23,0	script	DEBUG	328,{

	if ($@EVENTO_STATUS == 1) goto L_Debug2;

L_Debug:
	mes "[DEBUG]";
	mes "\"O evento está desabilitado. Gostaria de habilitá-lo?\"";
	next;
	menu
		"DEBUG - Mostrar o valor de todas as variáveis envolvidas", L_Mostravars,
		"Habilitar no próximo minuto para ver os anúncios", L_Debug3,
		"Habilitar agora", -;

	set $@EVENTO_DEBUG, 1;
	mes "[DEBUG]";
	mes "\"Aguarde 5 segundos e converse comigo novamente.\"";
	close;

L_Debug2:
	mes "[DEBUG]";
	mes "\"O evento está habilitado. Gostaria de desabilitá-lo ou prosseguir normalmente?\"";
	next;
	menu
		"DEBUG - Mostrar o valor de todas as variáveis envolvidas", L_Mostravars,
		"Desabilitar", -,
		"Fechar", L_Fechar;

	set $@EVENTO_DEBUG, 0;
	mes "[DEBUG]";
	mes "\"Aguarde 5 segundos e converse comigo novamente.\"";
	close;

L_Debug3:
	set $@EVENTO_DEBUG, 2;
	mes "[DEBUG]";
	mes "\"Aguarde os anúncios\"";
	close;

L_Mostravars:
	mes "Status do evento: " + $@EVENTO_STATUS;
	mes "Status do modo Debug: " + $@EVENTO_DEBUG;
	next;
	mes "Grupo em que você foi cadastrado da ultima vez: " + grupoexistente;
	mes "Se o valor for zero, ou você nunca participou de um evento, ou você já conversou com o danboudor depois do último evento em que participou.";
	next;
	mes "ID do evento último evento em que você foi cadastrado: " + controledeeventos;
	mes "Esta ID você ganha assim que é cadastrado no evento. O valor dela é o mesmo da ID global do evento.";
	next;
	mes "ID GLOBAL do evento em vigência: " + $CONTROLE_EVENTOS;
	mes "Em cada evento a ID global é aumentada em +1. Isso serve para fazer que só seja possível resgatar seu prêmio no período entre o fim do evento atual e o inicio do próximo.";
	next;
	if ($@VENCEDOR_MORTES == 0) mes "O grupo ganhador do evento em vigência foi o grupo " + $VENCEDOR_GRUPO + " com " + $@VENCEDOR_PILARES +  " totens e " + $@VENCEDOR_MORTES + " vitorias em pvp, que não foram levadas em consideração.";
	if ($@VENCEDOR_MORTES != 0) mes "O grupo ganhador do evento em vigência foi o grupo " + $VENCEDOR_MORTES_GRUPO +  " com " + $@VENCEDOR_PILARES +  " totens e " + $@VENCEDOR_MORTES + " vitorias em pvp";
	if (getarraysize($EMPATADOS) == 1) mes "Não houve empate.";
	if (getarraysize($EMPATADOS) != 1 && getarraysize($EMPATADOS_MORTES) == 1 && $@VENCEDOR_MORTES == 0) mes "Houve empate, mas ninguém matou ninguém, o que prejudicou o critério de desempate.";
	if (getarraysize($EMPATADOS) != 1 && getarraysize($EMPATADOS_MORTES) == 1 && $@VENCEDOR_MORTES != 0) mes "Houve empate, e o grupo " + $VENCEDOR_MORTES_GRUPO + " venceu pelo critério de desempate.";
	if (getarraysize($EMPATADOS) != 1 && getarraysize($EMPATADOS_MORTES) != 1) mes "Houve empate no número de totens e no numero de vitorias em pvp entre o grupo ganhador e os grupos: " + $EMPATADOS_MORTES[1] + " - " + $EMPATADOS_MORTES[2] + " - " + $EMPATADOS_MORTES[3] + " - " + $EMPATADOS_MORTES[4] + " - " + $EMPATADOS_MORTES[5] + " - " + $EMPATADOS_MORTES[6] + " - " + $EMPATADOS_MORTES[7] + " - " + $EMPATADOS_MORTES[8] + " - " + $EMPATADOS_MORTES[9] + " - " + $EMPATADOS_MORTES[10] + " - " + $EMPATADOS_MORTES[11] + " - " + $EMPATADOS_MORTES[12];
	next;
	mes "Tempo de inicio do evento(só deve aparecer se Status do evento = 1): " + $@EVENTO_INICIO;
	next;
	if (getarraysize($@GRUPOS_AUTOEVENTO$) == 1) goto L_2;
L_1:
	mes "Grupos cadastrados(só deve aparecer se Status do evento = 1): " 
	+ $@GRUPOS_AUTOEVENTO$[1]
	+ $@GRUPOS_AUTOEVENTO$[2]
	+ $@GRUPOS_AUTOEVENTO$[3]
	+ $@GRUPOS_AUTOEVENTO$[4]
	+ $@GRUPOS_AUTOEVENTO$[5]
	+ $@GRUPOS_AUTOEVENTO$[6]
	+ $@GRUPOS_AUTOEVENTO$[7]
	+ $@GRUPOS_AUTOEVENTO$[8]
	+ $@GRUPOS_AUTOEVENTO$[9]
	+ $@GRUPOS_AUTOEVENTO$[10]
	+ $@GRUPOS_AUTOEVENTO$[11]
	+ $@GRUPOS_AUTOEVENTO$[12];
	goto L_3;
L_2:
	mes "Nenhum grupo cadastrado.";
L_3:
	next;
	if (getarraysize($@GRUPO1$) != 1) mes "Há pessoas cadastradas no grupo 1";
	if (getarraysize($@GRUPO1$) == 1) mes "Ninguém no grupo 1";
	if (getarraysize($@GRUPO2$) != 1) mes "Há pessoas cadastradas no grupo 2";
	if (getarraysize($@GRUPO2$) == 1) mes "Ninguém no grupo 2";
	if (getarraysize($@GRUPO3$) != 1) mes "Há pessoas cadastradas no grupo 3";
	if (getarraysize($@GRUPO3$) == 1) mes "Ninguém no grupo 3";
	if (getarraysize($@GRUPO4$) != 1) mes "Há pessoas cadastradas no grupo 4";
	if (getarraysize($@GRUPO4$) == 1) mes "Ninguém no grupo 4";
	if (getarraysize($@GRUPO5$) != 1) mes "Há pessoas cadastradas no grupo 5";
	if (getarraysize($@GRUPO5$) == 1) mes "Ninguém no grupo 5";
	if (getarraysize($@GRUPO6$) != 1) mes "Há pessoas cadastradas no grupo 6";
	if (getarraysize($@GRUPO6$) == 1) mes "Ninguém no grupo 6";
	if (getarraysize($@GRUPO7$) != 1) mes "Há pessoas cadastradas no grupo 7";
	if (getarraysize($@GRUPO7$) == 1) mes "Ninguém no grupo 7";
	if (getarraysize($@GRUPO8$) != 1) mes "Há pessoas cadastradas no grupo 8";
	if (getarraysize($@GRUPO8$) == 1) mes "Ninguém no grupo 8";
	if (getarraysize($@GRUPO9$) != 1) mes "Há pessoas cadastradas no grupo 9";
	if (getarraysize($@GRUPO9$) == 1) mes "Ninguém no grupo 9";
	if (getarraysize($@GRUPO10$) != 1) mes "Há pessoas cadastradas no grupo 10";
	if (getarraysize($@GRUPO10$) == 1) mes "Ninguém no grupo 10";
	if (getarraysize($@GRUPO11$) != 1) mes "Há pessoas cadastradas no grupo 11";
	if (getarraysize($@GRUPO11$) == 1) mes "Ninguém no grupo 11";
	if (getarraysize($@GRUPO12$) != 1) mes "Há pessoas cadastradas no grupo 12";
	if (getarraysize($@GRUPO12$) == 1) mes "Ninguém no grupo 12";
	next;
	if (getarraysize($@PILARES_DONOS) == 1) mes "Nenhum Pilar tem dono";
	if (getarraysize($@PILARES_DONOS) == 1) goto L_4;
	mes "Pilar 1 pertence ao grupo número " + $@PILARES_DONOS[1];
	mes "Pilar 2 pertence ao grupo número " + $@PILARES_DONOS[2];
	mes "Pilar 3 pertence ao grupo número " + $@PILARES_DONOS[3];
	mes "Pilar 4 pertence ao grupo número " + $@PILARES_DONOS[4];
	mes "Pilar 5 pertence ao grupo número " + $@PILARES_DONOS[5];
	mes "Pilar 6 pertence ao grupo número " + $@PILARES_DONOS[6];
	mes "Pilar 7 pertence ao grupo número " + $@PILARES_DONOS[7];
	mes "Pilar 8 pertence ao grupo número " + $@PILARES_DONOS[8];
	mes "Pilar 9 pertence ao grupo número " + $@PILARES_DONOS[9];
	mes "Pilar 10 pertence ao grupo número " + $@PILARES_DONOS[10];
	mes "Pilar 11 pertence ao grupo número " + $@PILARES_DONOS[11];
	mes "Pilar 12 pertence ao grupo número " + $@PILARES_DONOS[12];
L_4:
	next;
	mes "verificando se o indice zero está preenchido em alguma das variaveis";
	next;
	mes $@GRUPOS_AUTOEVENTO$[0];
	mes $@GRUPO1$[0];
	mes $@GRUPO2$[0];
	mes $@GRUPO3$[0];
	mes $@GRUPO4$[0];
	mes $@GRUPO5$[0];
	mes $@GRUPO6$[0];
	mes $@GRUPO7$[0];
	mes $@GRUPO8$[0];
	mes $@GRUPO9$[0];
	mes $@GRUPO10$[0];
	mes $@GRUPO11$[0];
	mes $@GRUPO12$[0];
	mes $@PILARES_DONOS[0];
	close;

L_Fechar:
	close;

}
