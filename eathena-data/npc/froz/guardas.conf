froz.gat,94,72,0	script	#FrozPorta1Fechada	604,2,0,{
	if($Froz_InvasaoPermitida==0) goto _inicio;
	disablenpc "#FrozPorta1Aberta";
	pvpoff "froz.gat";
	pvpoff "froz001.gat";
	pvpoff "froz002.gat";
	killmonster "froz.gat", "ArrebentarFroz";
	killmonster "froz.gat", "ArrebentarFroz::onPetDeath1";
	killmonster "froz.gat", "ArrebentarFroz::onPetDeath2";

_inicio:
	if($Froz_Porta1==3 || ($Froz_Porta1==2 && (Reino==$PosseDeFroz || gettime(4)==6)) || ($Froz_Porta1==1 && Reino==$PosseDeFroz)) goto _entrar;
	mes "["+strcharinfo(0)+"]";
	menu
	"Toc! Toc! Quero entrar!", _TocToc,
	"Quero invadir este reino!", _Arrebentar,
	"Nada! Deixa quieto!", -;
close;

_TocToc:
	callfunc "TocTocFroz";
close;

_Arrebentar:
	if(Reino==$PosseDeFroz) goto _MensagemAoTraidor;
	if(Reino==0) goto _MensagemAoHeremita;
	//if(gettime(4)!=6 || gettime(3)<14 || gettime(3)>17) goto _FalhaDeMomento; //← desabilite essa linha para invadir todos dos dias!
	if($Froz_InvasaoPermitida!=1) goto _FalhaAoArrebentar;
	//set $@FrozID, getcharid(3);
	misceffect 314;
	pvpon "froz.gat";
	pvpon "froz001.gat";
	pvpon "froz002.gat";
	announce "Froz está sendo atacada!", 0;
	set @inFront, getareausers("froz.gat", 21, 72, 162, 98);
	monster "froz.gat", 94, 72, "", 1376, 1, "ArrebentarFroz";
	areamonster "froz.gat", 92, 73, 95, 74, "", 1378, @inFront*3, "ArrebentarFroz::onPetDeath1";
	disablenpc "#FrozPorta1Fechada";
close;

_FalhaAoArrebentar:
	mes "";
	mes "["+strcharinfo(0)+"]";
	mes "=S \"Mas infelizmente está protigido magicamente!\"";
close;

_FalhaDeMomento:
	mes "";
	mes "["+strcharinfo(0)+"]";
	mes "=D \"Mas vou invadir as 14h deste sábado!\"";
close;

_MensagemAoHeremita:
	mes "";
	mes "["+strcharinfo(0)+"]";
	mes "\"Mas não posso, pois sou apenas um heremita que não é cidadão de algum reino!\"";
close;

_MensagemAoTraidor:
	mes "";
	mes "["+strcharinfo(0)+"]";
	mes "\"Mas seria tolice invadir meu próprio reino!\"";
close;

_entrar:
	misceffect 313;
	warp "froz.gat", 94, 69;
end;
}
//-----------------------------------------------------------------------------------------------

froz.gat,94,72,0	script	ArrebentarFroz	-1,{
	announce "O portão de Froz foi arrebentado!", 0;
	enablenpc "#FrozPorta1Aberta";
	set @inFront, getareausers("froz.gat", 21, 72, 162, 98); //Quantos na frente
	set @mobFront, mobcount("froz.gat", "ArrebentarFroz::onPetDeath2");
	//areamonster "froz.gat", 21, 20, 175, 66, "", 1378, ((@inFront*4)-@mobFront), "ArrebentarFroz::onPetDeath2"; //Sumona dentro do reino inteiro!
	areamonster "froz.gat", 87, 59, 100, 66, "", 1378, ((@inFront*2)-@mobFront), "ArrebentarFroz::onPetDeath2"; //Sumona atraz do portão!
	killmonster "froz.gat", "ArrebentarFroz::onPetDeath1";
end;

onPetDeath1:
	//attachrid($@FrozID);
	set @inFront, getareausers("froz.gat", 21, 72, 162, 98); //Quantos na frente
	set @mobFront, mobcount("froz.gat", "ArrebentarFroz::onPetDeath1");
	areamonster "froz.gat", 92, 73, 95, 74, "", 1378, ((@inFront*2)-@mobFront), "ArrebentarFroz::onPetDeath1";  //Sumona na frente do portão!
	//announce "ArrebentarFroz::onPetDeath1="+@mobFront;
end;

onPetDeath2:
	//attachrid($@FrozID);
	set @inFront, getareausers("froz.gat", 21, 20, 175, 66);
	set @mobFront, mobcount("froz.gat", "ArrebentarFroz::onPetDeath2");
	areamonster "froz.gat", 21, 20, 175, 66, "", 1378, ((@inFront*10)-@mobFront), "ArrebentarFroz::onPetDeath2"; //Sumona dentro do reino inteiro!
	//announce "ArrebentarFroz::onPetDeath2="+@mobFront;
end;

}

//------------------------------------------------------------------------------------------------------------------------------------------------

froz.gat,94,72,0	script	#FrozPorta1Aberta	300,2,0,{
	if($Froz_InvasaoPermitida!=1) goto _PararInvasao;
	warp "froz.gat", 94, 69;
end;

_PararInvasao:
	enablenpc "#FrozPorta1Fechada";
	disablenpc "#FrozPorta1Aberta";
end;
}

//-----------------------------------------------------------------------------------------------

function	script	TocTocFroz	{
	//if (getgmlevel(0)>=99) goto _entrar;
	if($Froz_Porta1==3 || ($Froz_Porta1==2 && (Reino==$PosseDeFroz || gettime(4)==6)) || ($Froz_Porta1==1 && Reino==$PosseDeFroz)) goto _entrar;
	
	if(Reino==0) set @NomeReino$, "lugares desconhecidos";
	if(Reino==1) set @NomeReino$, "Bhramir";
	if(Reino==2) set @NomeReino$, "Halicarnazo";
	if(Reino==3) set @NomeReino$, "Froz";

	mes "";
	mes "[Ohniralc]";
	if(Sex==0) mes ">=] \"Parada aeee elementa de "+@NomeReino$+"!";
	if(Sex==1) mes ">=] \"Parado aeee sujeito de "+@NomeReino$+"!";
   next;
	//npctalk "mensagem publica!";
	mes "[Ohniralc]";
	if($Froz_Porta1==0) mes "A entrada de todos ainda está impedida.\"";
	if($Froz_Porta1==1) mes "A entrada de visitantes aos sábados ainda está impedida.\"";
	if($Froz_Porta1==2) mes "A entrada de visitantes aos sábados ainda está permitida.\"";
	if($Froz_Porta1==3) mes "A entrada de todos ainda está permitida.\"";
close;

_entrar:
	warp "froz.gat", 94, 69;
end;
}

//-----------------------------------------------------------------------------------------------

froz.gat,93,75,0	script	Ohniralc	601,{
	if(Reino==0) set @NomeReino$, "lugares desconhecidos";
	if(Reino==1) set @NomeReino$, "Bhramir";
	if(Reino==2) set @NomeReino$, "Halicarnazo";
	if(Reino==3) set @NomeReino$, "Froz";
	if (getgmlevel(0)>=99) goto _comprimetar;
	mes "[Ohniralc]";
	mes ">=] \"Pois bem cidadão de "+@NomeReino$+".";
	if($Froz_Porta1==0) mes "A entrada de todos ainda está impedida.\"";
	if($Froz_Porta1==1) mes "A entrada de visitantes aos sábados ainda está impedida.\"";
	if($Froz_Porta1==2) mes "A entrada de visitantes aos sábados ainda está permitida.\"";
	if($Froz_Porta1==3) mes "A entrada de todos ainda está permitida.\"";
close;

_comprimetar:
	mes "[Ohniralc]";
	if(Sex==0) mes "\"Olá! My Lady!\"";
	if(Sex==1) mes "\"Olá! My Lord!\"";
	next;
_ofereceAjuda:
	mes "";
	mes "[Ohniralc]";
	mes "=) \"Então, em que posso ajudar?\"";
	next;
	if($Froz_InvasaoPermitida!=1) set @mensagem$, "Remover Proteção Mágica!";
	if($Froz_InvasaoPermitida==1) set @mensagem$, "Adicionar Proteção Mágica!";
	mes "["+strcharinfo(0)+"]";
	menu
		" → Registre nova Nacionalidade!", _controlarNacionalidade,
		" → Como é o controle deste portão?", _controlarPortao,
		" → "+@mensagem$, -,
		" → Fechar Portão!", _RestaurarPortao,
		" → Entregar este a uma nova população.", _EntregarReino,
		"Nada! Dispensado!", -;
	if(@menu==3 && $Froz_InvasaoPermitida==1) goto _ProtecaoAdicionar;
	if(@menu==3 && $Froz_InvasaoPermitida!=1) goto _ProtecaoRetirar;

	mes "";
	mes "[Ohniralc]";
	mes "=O \"Vida longa a "+strcharinfo(0)+"!!!!!\"";
close;

_controlarNacionalidade:
	if(Reino==0) set @NomeReino$, "lugares desconhecidos";
	if(Reino==1) set @NomeReino$, "Bhramir";
	if(Reino==2) set @NomeReino$, "Halicarnazo";
	if(Reino==3) set @NomeReino$, "Froz";
	mes "";
	mes "[Ohniralc]";
	mes "=D \"Você pertence a "+@NomeReino$+".";
	next;
	mes "[Ohniralc]";
	mes "Selecione sua nova nacionalidade:\"";
	menu
		" → Bhramir", -,
		" → Halicarnazo", -,
		" → Froz", -,
		" → Nenhuma Nacionalidade", -,
		"Deixa para depois!", _ofereceAjuda;
	if(@menu>=1 && @menu<=3) set Reino,@menu;
	if(@menu<=0 || @menu>=4) set Reino,0;

	mes "";
	mes "[Ohniralc]";
	mes "\"Entendido!\"";
	next;
goto _ofereceAjuda;

_controlarPortao:
	mes "";
	mes "[Ohniralc]";
	if($Froz_Porta1==0) mes "\"A entrada de todos ainda está impedida.\"";
	if($Froz_Porta1==1) mes "\"A entrada de visitantes aos sábados ainda está impedida.\"";
	if($Froz_Porta1==2) mes "\"A entrada de visitantes aos sábados ainda está permitida.\"";
	if($Froz_Porta1==3) mes "\"A entrada de todos ainda está permitida.\"";
	next;
	mes "["+strcharinfo(0)+"]";
	menu
	"Impeça a entrada de todos!", -,
	"Impeça a entrada de visitantes aos sábados!", -,
	"Permita a entrada de visitantes aos sábados!", -,
	"Permita a entrada de todos!", -,
	"Deixa para depois!", _ofereceAjuda;
	if(@menu>=1 && @menu<=4) set $Froz_Porta1,@menu-1;
	mes "";
	mes "[Ohniralc]";
	mes "\"Entendido!\"";
	next;
goto _ofereceAjuda;

_RestaurarPortao:
	//attachrid($@FrozID);
	enablenpc "Estátua#1";
	set $Froz_EstatuasArrebentadas,0; //← Volta ao incício
	pvpoff "froz.gat"; // ← PVPOFF não ta funcionando de jeito nenhum! =S
	pvpoff "froz001.gat";
	pvpoff "froz002.gat";
	enablenpc "#FrozPorta1Fechada";
	disablenpc "#FrozPorta1Aberta";
	killmonster "froz.gat", "ArrebentarFroz";
	killmonster "froz.gat", "ArrebentarFroz::onPetDeath1";
	killmonster "froz.gat", "ArrebentarFroz::onPetDeath2";
	mes "";
	mes "[Ohniralc]";
	mes "\"Portão Fechado!\"";
	next;
goto _ofereceAjuda;

_ProtecaoRetirar:
	set $Froz_InvasaoPermitida, 1;
	mes "";
	mes "[Ohniralc]";
	mes "\"Ok! A proteção mágica no portão foi removida!\"";
	next;
goto _ofereceAjuda;

_ProtecaoAdicionar:
	set $Froz_InvasaoPermitida, 0;
	mes "";
	mes "[Ohniralc]";
	mes "\"Ok! A proteção mágica no portão foi refeita!\"";
	next;
goto _RestaurarPortao;

_EntregarReino:
	if($PosseDeFroz==0) set @NomeReino$, "Froz pertece a todos neste mundo.";
	if($PosseDeFroz==1) set @NomeReino$, "Froz pertece ao povo do reino de Bhramir.";
	if($PosseDeFroz==2) set @NomeReino$, "Froz pertece ao povo do reino de Halicarnazo.";
	if($PosseDeFroz==3) set @NomeReino$, "Froz pertece ao povo do reino de Froz.";
	mes "";
	mes "[Ohniralc]";
	mes "=D \""+@NomeReino$+"\"";
	next;
	mes "[Ohniralc]";
	mes "Selecione quem possuirá esta cidade:\"";
	menu
		" → Povo de Bhramir", -,
		" → Povo de Halicarnazo", -,
		" → Povo de Froz", -,
		" → Todos dos Povos!", -,
		"Deixa para depois!", _ofereceAjuda;
	if(@menu>=1 && @menu<=3) set $PosseDeFroz,@menu;
	if(@menu<=0 || @menu>=4) set $PosseDeFroz,0;
	mes "";
	mes "[Ohniralc]";
	mes "\"Entendido!\"";
	next;
goto _ofereceAjuda;

}
