// checa se o prêmio em XP excede o limite definido na tabela abaixo.
// em caso positivo, o prêmio é redefinido para o limite da tabela.

function	script	checaxp	{

	setarray @lvl,              // 5
	4,     8,     12,    17,    36,    52,    70,    91,    114,   142,    // 01..10
	169,   213,   252,   298,   349,   403,   459,   510,   568,   640,    // 11..20
	725,   766,   851,   939,   1092,  1250,  1416,  1588,  2411,  2758,   // 21..30
	3119,  3492,  3877,  4539,  5048,  5569,  6100,  6641,  9163,  10093,  // 31..40
	11039, 11999, 12970, 14582, 15773, 16971, 18172, 19373, 25617, 28237,  // 41..50
	30886, 33554, 36231, 40091, 43186, 46268, 49325, 52345, 66038, 71353,  // 51..60
	76613, 81791, 86866, 93966, 99482, 104821,109954,114853,138810,213693, // 61..70
	223168,232055,240286,247793,267614,274409,280216,284957,320616,349697, // 71..80
	362022,372047,379574,384408,403709,403260,399328,391692,380130,438242, // 81..90
	465998,477523,550179,595920,713160,730305,781350,800000,810000;        // 91..99

	set @expquest, @lvl[@baseexp-1];
	set BaseExp, BaseExp+@expquest;
	return;
}

/**
 * Retorna a quantidade máxima de XP que um jogador pode ganhar em um
 * determinado level.
 * Muito util em quests tempoárias, onde o jogador não pode esperar subir
 * de level a tempo de fazer a missão. Ele conclui a missão e ganha seu
 * prêmio máximo.
 *
 * @param arg0 Quantidade de XP que iria ganhar.
 * @return @xp A quantidade corrigida de XP.
 */
function	script	getXpMax	{

	setarray @lvl,              // 5
	4,     8,     12,    17,    36,    52,    70,    91,    114,   142,    // 01..10
	169,   213,   252,   298,   349,   403,   459,   510,   568,   640,    // 11..20
	725,   766,   851,   939,   1092,  1250,  1416,  1588,  2411,  2758,   // 21..30
	3119,  3492,  3877,  4539,  5048,  5569,  6100,  6641,  9163,  10093,  // 31..40
	11039, 11999, 12970, 14582, 15773, 16971, 18172, 19373, 25617, 28237,  // 41..50
	30886, 33554, 36231, 40091, 43186, 46268, 49325, 52345, 66038, 71353,  // 51..60
	76613, 81791, 86866, 93966, 99482, 104821,109954,114853,138810,213693, // 61..70
	223168,232055,240286,247793,267614,274409,280216,284957,320616,349697, // 71..80
	362022,372047,379574,384408,403709,403260,399328,391692,380130,438242, // 81..90
	465998,477523,550179,595920,713160,730305,781350,800000,0;             // 91..99

	set @xp, getarg(0);
	if(@xp > @lvl[BaseLevel-1])
		set @xp, @lvl[BaseLevel-1];
	return;
}
