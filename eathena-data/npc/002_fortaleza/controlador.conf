// NPC que controla quem matou os totems

// Variáveis:

// Não Globais temporárias:
// @loop - Usada quando é necessário passar pelos elementos de uma array(array[@loop], onde @loop é acrescido de +1 até o fim da array)

// Globais Temporárias:
// $@LOOP - A mesma função de @loop, mas nos contextos em que não há um RID atachado à execução do script
// $@EVENTO_STATUS - 0 = desabilitado, 1 = habilitado, 2 = Fase de anúncios
// $@EVENTO_DEBUG - 0 = Debug desabilitado 1 = Debug habilitado
// $@EVENTO_INICIO - Momento em que se inicia o evento (Unix timestamp)
// $@ANUNCIOS - Variável de controle para definir quais textos serão exibidos durante o período de anúncios.
// $@GRUPOS_AUTOEVENTO$ - Lista com o nome dos grupos participantes
// $@PILARES_DONOS - Array contendo o número dos atuais "donos" dos pilares
// $@MORTES_EVENTO_PILARES - Array contendo a quantidade de mortes em PVP conseguidas por cada grupo
// $@GRUPO1$, $@GRUPO2$, etc - Nome de cada grupo
// $@GRUPO1_PILARES, $@GRUPO2_PILARES, etc - Quantidade de pilares derrubados por cada grupo.
// $@VENCEDOR_PILARES - Quantidade de pilares derrubados pelo grupo vencedor
// $@VENCEDOR_MORTES - Número de mortes conseguidas pelo grupo mais eficiente no PVP

// Não globais Permanentes:
// controledeeventos - ID global do evento atual($CONTROLE_EVENTOS) no âmbito do jogador, para controlar quando ele pode resgatar o prêmio.
// grupoexistente - Número do grupo em que o jogador foi inserido.

// Globais Permanentes:
// $CONTROLE_EVENTOS - Uma espécie de ID única de cada evento. A cada evento esta variável é acrescida em +1.
// $VENCEDOR_MORTES_GRUPO - Número do grupo mais eficiente no quesito PVP entre os empatados no quesito "Derrubada de pilar"
// $EMPATADOS - Array com os grupos empatados no quesito "derrubada de pilares"
// $EMPATADOS_MORTES - Array com o número dos grupos empatados nos quesitos "derrubada de pilares" E "morte em pvp"
// $VENCEDOR_GRUPO - Número do grupo vencedor

002.gat,107,115,0	script	#Controle	45,{

	end;

L_Iniciar:
	monster "002.gat", 93, 105, "", 1014, 1, "#Controle::OnPilar1Death";
	monster "002.gat", 93, 100, "", 1014, 1, "#Controle::OnPilar2Death";
	monster "002.gat", 93, 95, "", 1014, 1, "#Controle::OnPilar3Death";
	monster "002.gat", 93, 90, "", 1014, 1, "#Controle::OnPilar4Death";
	monster "002.gat", 93, 85, "", 1014, 1, "#Controle::OnPilar5Death";
	monster "002.gat", 105, 105, "", 1014, 1, "#Controle::OnPilar6Death";
	monster "002.gat", 105, 100, "", 1014, 1, "#Controle::OnPilar7Death";
	monster "002.gat", 105, 95, "", 1014, 1, "#Controle::OnPilar8Death";
	monster "002.gat", 105, 90, "", 1014, 1, "#Controle::OnPilar9Death";
	monster "002.gat", 105, 85, "", 1014, 1, "#Controle::OnPilar10Death";
	monster "002.gat", 101, 85, "", 1014, 1, "#Controle::OnPilar11Death";
	monster "002.gat", 97, 85, "", 1014, 1, "#Controle::OnPilar12Death";
	set $@EVENTO_STATUS, 1;
	set $@EVENTO_DEBUG, 1;
	set $@EVENTO_INICIO, gettimetick(2);
	set $CONTROLE_EVENTOS, $CONTROLE_EVENTOS + 1;
	set $@VENCEDOR_PILARES, 0;
	set $VENCEDOR_GRUPO, 0;
	set $@VENCEDOR_MORTES, 0;
	set $VENCEDOR_MORTES_GRUPO, 0;
	cleararray $EMPATADOS_MORTES[0], 0, 13;
	cleararray $EMPATADOS[0], 0, 13;
	end;

OnTimer5000:
	setnpctimer 0;
//	if (gettime(4) != 6 || gettime(3) < 18) end;
//	if (gettime(3) > 20 && $@EVENTO_STATUS == 1) goto L_Limpar;
//	if (gettime(3) == 18 || (gettime(3) == 19 && gettime(2) == 0)) goto L_Anuncios;
//	Modo debug
	if ($@EVENTO_STATUS == 0 && $@EVENTO_DEBUG == 1) goto L_Iniciar;
	if ($@EVENTO_STATUS == 1 && $@EVENTO_DEBUG == 0) goto L_Limpar;
	if ($@EVENTO_STATUS == 1) goto L_Checar_Tempo;
	if ($@EVENTO_STATUS == 0 && $@EVENTO_DEBUG == 2) goto L_Anuncios;
	end;

OnPilar1Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	message strcharinfo(0), getarraysize($@PILARES_DONOS);
	if ($@PILARES_DONOS[1] != @loop) announce "O Pilar de Aries foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@PILARES_DONOS[1] != @loop) set $@PILARES_DONOS[1], @loop;
	message strcharinfo(0), $@PILARES_DONOS[1];
	message strcharinfo(0), getarraysize($@PILARES_DONOS);
	monster "002.gat", 93, 105, "", 1014, 1, "#Controle::OnPilar1Death";
	end;

OnPilar2Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@PILARES_DONOS[2] != @loop) announce "O Pilar de Touro foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@PILARES_DONOS[2] != @loop) set $@PILARES_DONOS[2], @loop;
	monster "002.gat", 93, 100, "", 1014, 1, "#Controle::OnPilar2Death";
	end;

OnPilar3Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@PILARES_DONOS[3] != @loop) announce "O Pilar de Gêmeos foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@PILARES_DONOS[3] != @loop) set $@PILARES_DONOS[3], @loop;
	monster "002.gat", 93, 95, "", 1014, 1, "#Controle::OnPilar3Death";
	end;

OnPilar4Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@PILARES_DONOS[4] != @loop) announce "O Pilar de Câncer foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@PILARES_DONOS[4] != @loop) set $@PILARES_DONOS[4], @loop;
	monster "002.gat", 93, 90, "", 1014, 1, "#Controle::OnPilar4Death";
	end;

OnPilar5Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@PILARES_DONOS[5] != @loop) announce "O Pilar de Leão foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@PILARES_DONOS[5] != @loop) set $@PILARES_DONOS[5], @loop;
	monster "002.gat", 93, 85, "", 1014, 1, "#Controle::OnPilar5Death";
	end;

OnPilar6Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@PILARES_DONOS[6] != @loop) announce "O Pilar de Virgem foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@PILARES_DONOS[6] != @loop) set $@PILARES_DONOS[6], @loop;
	monster "002.gat", 105, 105, "", 1014, 1, "#Controle::OnPilar6Death";
	end;

OnPilar7Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@PILARES_DONOS[7] != @loop) announce "O Pilar de Libra foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@PILARES_DONOS[7] != @loop) set $@PILARES_DONOS[7], @loop;
	monster "002.gat", 105, 100, "", 1014, 1, "#Controle::OnPilar7Death";
	end;

OnPilar8Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@PILARES_DONOS[8] != @loop) announce "O Pilar de Escorpião foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@PILARES_DONOS[8] != @loop) set $@PILARES_DONOS[8], @loop;
	monster "002.gat", 105, 95, "", 1014, 1, "#Controle::OnPilar8Death";
	end;

OnPilar9Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@PILARES_DONOS[9] != @loop) announce "O Pilar de Sagitário foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@PILARES_DONOS[9] != @loop) set $@PILARES_DONOS[9], @loop;
	monster "002.gat", 105, 90, "", 1014, 1, "#Controle::OnPilar9Death";
	end;

OnPilar10Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@PILARES_DONOS[10] != @loop) announce "O Pilar de Capricórnio foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@PILARES_DONOS[10] != @loop) set $@PILARES_DONOS[10], @loop;
	monster "002.gat", 105, 85, "", 1014, 1, "#Controle::OnPilar10Death";
	end;

OnPilar11Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@PILARES_DONOS[11] != @loop) announce "O Pilar de Aquário foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@PILARES_DONOS[11] != @loop) set $@PILARES_DONOS[11], @loop;
	monster "002.gat", 101, 85, "", 1014, 1, "#Controle::OnPilar11Death";
	end;

OnPilar12Death:
	set @loop, 0;
	callsub S_QUALGRUPO;
	if ($@PILARES_DONOS[12] != @loop) announce "O Pilar de Peixes foi derrubado pela família " + getpartyname(getcharid(1)), 0;
	if ($@PILARES_DONOS[12] != @loop) set $@PILARES_DONOS[12], @loop;
	monster "002.gat", 97, 85, "", 1014, 1, "#Controle::OnPilar12Death";
	end;

L_Anuncios:
//	Valores apenas para teste
	if (gettime(1) >= 10 && gettime(1) <= 20 && $@ANUNCIOS == 0) goto L_Anuncio1;
	if (gettime(1) >= 20 && gettime(1) <= 30 && $@ANUNCIOS == 1) goto L_Anuncio2;
	if (gettime(1) >= 30 && gettime(1) <= 40 && $@ANUNCIOS == 2) goto L_Anuncio3;
	if (gettime(1) >= 40 && gettime(1) <= 50 && $@ANUNCIOS == 3) goto L_Anuncio4;
	if (gettime(1) >= 50 && gettime(1) <= 59 && $@ANUNCIOS == 4) goto L_Anuncio5;
	if (gettime(1) >= 0 && gettime(1) <= 10 && $@ANUNCIOS == 5) goto L_Anuncio6;
	end;

L_Anuncio1:
	announce "Os Pilares de Érnegon sustentam o Mundo de Mana desde tempos imemoriais... Recentemente, passaram a sofrer instabilidades, devido ao alinhamento galáctico. Forças universais estão abaladas e poderosos Alquimistas acreditam que isto perdurará por mil anos.", 0;
	set $@ANUNCIOS, 1;
	end;

L_Anuncio2:
	announce "Desde eras mitológicas até esses últimos dias, os Pilares de Érnegon permaneceram ocultos na região do Castelo Brhamir. Garantindo a todos os povos o equilíbrio necessário para sustentar toda a existência com paz.", 0;
	set $@ANUNCIOS, 2;
	end;

L_Anuncio3:
	announce "Com o tempo das trevas a energia mana dos Pilares de Érnegon foi quase esgotada. A quantidade de mana que restou já não é suficiente para manter a invisibilidade e defesa dos Pilares. Estão vulneráveis no Jardim do Castelo e sofrendo ataques do submundo. Será este o fim?", 0;
	set $@ANUNCIOS, 3;
	end;

L_Anuncio4:
	announce "Existem segredos milenares guardados exclusivamente no Reino de Lilith: 'Reza a lenda que os Pilares de Érnegon quando fracos precisam ser destruídos por irmãos de uma Família', somente assim os pilares serão renovados.", 0;
	set $@ANUNCIOS, 4;
	end;

L_Anuncio5:
	announce "Generais Mágicos e Alquimistas unem esforços para despertar o Mestre dos Magos, Danboudor! Ele é sábio e poderoso para aperfeiçoar com magia e conhecimento as Famílias. Caso consigam, Danboudor aparecerá por pouco tempo no Portão do Castelo...", 0;
	set $@ANUNCIOS, 5;
	end;

L_Anuncio6:
	announce "A batalha pela vida e perpetuação das raças é trágica e violenta... O odor de sangue pode ser sentido desde a entrada da Vila! Apenas uma Família sairá vitoriosa... Ao ataque cavaleiros e amazonas, pouco tempo nos resta!!!", 0;
	set $@ANUNCIOS, 0;
	goto L_Iniciar;

L_Checar_Tempo:
	if (gettimetick(2) - $@EVENTO_INICIO > 30) goto L_Fim_Evento;
	end;

OnPCKilledEvent:
	if ($@EVENTO_STATUS != 1) end;
	attachrid(@killerrid);
	if (controledeeventos == $CONTROLE_EVENTOS && $CONTROLE_EVENTOS != 0 && grupoexistente != 0) goto L_Matou;
	end;

L_Matou:
	announce strcharinfo(0) + " derrotou um inimigo no campo ", 0;
	message strcharinfo(0), "Aê! Você derrotou alguém!";
	percentheal -100, 0;
	set $@MORTES_EVENTO_PILARES[grupoexistente], $@MORTES_EVENTO_PILARES[grupoexistente] + 1;
	end;

L_Fim_Evento:
	set $@LOOP, 0;
	callsub S_CONTAGEM;
	set $@LOOP, 0;
	set $VENCEDOR_GRUPO, 0;
	set $@VENCEDOR_PILARES, 0;
	set $@VENCEDOR_MORTES, 0;
	callsub S_COMPARA;
	callsub S_REPETIDOS;
	callsub S_DESEMPATE;
	set $@LOOP, 0;
	callsub S_DESEMPATE_REPETIDOS;
	if ($@VENCEDOR_PILARES != 0 && getarraysize($EMPATADOS) == 1) announce "A família " + $@GRUPOS_AUTOEVENTO$[$VENCEDOR_GRUPO] + " capturou " + $@VENCEDOR_PILARES + " Pilares e ganhou o evento!", 0;
	if ($@VENCEDOR_PILARES == 0) announce "Nenhum Pilar foi derrubado. Ninguém ganhou. :D", 0;
	if ($@VENCEDOR_PILARES != 0 && getarraysize($EMPATADOS) != 1) goto L_Anuncia_Empate_Simples;
	goto L_Limpar;

L_Anuncia_Empate_Simples:
	if (getarraysize($EMPATADOS_MORTES) != 1 && $@VENCEDOR_MORTES != 0)  goto L_Anuncia_Empate_Mortes;
	if (getarraysize($EMPATADOS_MORTES) == 1 && $@VENCEDOR_MORTES != 0)  goto L_Anuncia_Vencedor_Mortes;
	announce "Os vencedores foram as seguintes famílias, que derrubaram " + $@VENCEDOR_PILARES + " totens cada uma: ", 0;
	announce "Família " + $@GRUPOS_AUTOEVENTO$[$VENCEDOR_GRUPO], 0;
	if ($EMPATADOS[1] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[1], 0;
	if ($EMPATADOS[2] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[2], 0;
	if ($EMPATADOS[3] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[3], 0;
	if ($EMPATADOS[4] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[4], 0;
	if ($EMPATADOS[5] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[5], 0;
	if ($EMPATADOS[6] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[6], 0;
	if ($EMPATADOS[7] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[7], 0;
	if ($EMPATADOS[8] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[8], 0;
	if ($EMPATADOS[9] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[9], 0;
	if ($EMPATADOS[10] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[10], 0;
	if ($EMPATADOS[11] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[11], 0;
	if ($EMPATADOS[12] != 0) announce "Família " + $@GRUPOS_AUTOEVENTO$[12], 0;
	goto L_Limpar;

L_Anuncia_Empate_Mortes:
	announce "Os vencedores foram as seguintes famílias, que derrubaram " + $@VENCEDOR_PILARES + " totens e derrotaram " + $@VENCEDOR_MORTES + " inimigos cada uma: ", 0;
	if ($@MORTES_EVENTO_PILARES[1] == $@VENCEDOR_MORTES && $@GRUPO1_PILARES == $@VENCEDOR_PILARES) announce "Família " + $@GRUPOS_AUTOEVENTO$[1], 0;
	if ($@MORTES_EVENTO_PILARES[2] == $@VENCEDOR_MORTES && $@GRUPO2_PILARES == $@VENCEDOR_PILARES) announce "Família " + $@GRUPOS_AUTOEVENTO$[2], 0;
	if ($@MORTES_EVENTO_PILARES[3] == $@VENCEDOR_MORTES && $@GRUPO3_PILARES == $@VENCEDOR_PILARES) announce "Família " + $@GRUPOS_AUTOEVENTO$[3], 0;
	if ($@MORTES_EVENTO_PILARES[4] == $@VENCEDOR_MORTES && $@GRUPO4_PILARES == $@VENCEDOR_PILARES) announce "Família " + $@GRUPOS_AUTOEVENTO$[4], 0;
	if ($@MORTES_EVENTO_PILARES[5] == $@VENCEDOR_MORTES && $@GRUPO5_PILARES == $@VENCEDOR_PILARES) announce "Família " + $@GRUPOS_AUTOEVENTO$[5], 0;
	if ($@MORTES_EVENTO_PILARES[6] == $@VENCEDOR_MORTES && $@GRUPO6_PILARES == $@VENCEDOR_PILARES) announce "Família " + $@GRUPOS_AUTOEVENTO$[6], 0;
	if ($@MORTES_EVENTO_PILARES[7] == $@VENCEDOR_MORTES && $@GRUPO7_PILARES == $@VENCEDOR_PILARES) announce "Família " + $@GRUPOS_AUTOEVENTO$[7], 0;
	if ($@MORTES_EVENTO_PILARES[8] == $@VENCEDOR_MORTES && $@GRUPO8_PILARES == $@VENCEDOR_PILARES) announce "Família " + $@GRUPOS_AUTOEVENTO$[8], 0;
	if ($@MORTES_EVENTO_PILARES[9] == $@VENCEDOR_MORTES && $@GRUPO9_PILARES == $@VENCEDOR_PILARES) announce "Família " + $@GRUPOS_AUTOEVENTO$[9], 0;
	if ($@MORTES_EVENTO_PILARES[10] == $@VENCEDOR_MORTES && $@GRUPO10_PILARES == $@VENCEDOR_PILARES) announce "Família " + $@GRUPOS_AUTOEVENTO$[10], 0;
	if ($@MORTES_EVENTO_PILARES[11] == $@VENCEDOR_MORTES && $@GRUPO11_PILARES == $@VENCEDOR_PILARES) announce "Família " + $@GRUPOS_AUTOEVENTO$[11], 0;
	if ($@MORTES_EVENTO_PILARES[12] == $@VENCEDOR_MORTES && $@GRUPO11_PILARES == $@VENCEDOR_PILARES) announce "Família " + $@GRUPOS_AUTOEVENTO$[12], 0;
	goto L_Limpar;

L_Anuncia_Vencedor_Mortes:
	announce "A família " + $@GRUPOS_AUTOEVENTO$[$@VENCEDOR_MORTES] + " derrubou " + $@VENCEDOR_PILARES + " Pilares e derrotou " + $@VENCEDOR_MORTES + " adversários, o que faz dela a vencedora do evento.", 0;
	goto L_Limpar;

S_QUALGRUPO:
	set @loop, @loop + 1;
	if ($@GRUPOS_AUTOEVENTO$[@loop] == getpartyname(getcharid(1))) return;
	if (@loop > 12) message strcharinfo(0), "nao achei seu grupo!";
	if (@loop > 12) return;
	goto S_QUALGRUPO;

S_CONTAGEM:
	set $@LOOP, $@LOOP + 1;
	if ($@LOOP > 12) return;
	if ($@PILARES_DONOS[$@LOOP] == 1) set $@GRUPO1_PILARES, $@GRUPO1_PILARES + 1;
	if ($@PILARES_DONOS[$@LOOP] == 2) set $@GRUPO2_PILARES, $@GRUPO2_PILARES + 1;
	if ($@PILARES_DONOS[$@LOOP] == 3) set $@GRUPO3_PILARES, $@GRUPO3_PILARES + 1;
	if ($@PILARES_DONOS[$@LOOP] == 4) set $@GRUPO4_PILARES, $@GRUPO4_PILARES + 1;
	if ($@PILARES_DONOS[$@LOOP] == 5) set $@GRUPO5_PILARES, $@GRUPO5_PILARES + 1;
	if ($@PILARES_DONOS[$@LOOP] == 6) set $@GRUPO6_PILARES, $@GRUPO6_PILARES + 1;
	if ($@PILARES_DONOS[$@LOOP] == 7) set $@GRUPO7_PILARES, $@GRUPO7_PILARES + 1;
	if ($@PILARES_DONOS[$@LOOP] == 8) set $@GRUPO8_PILARES, $@GRUPO8_PILARES + 1;
	if ($@PILARES_DONOS[$@LOOP] == 9) set $@GRUPO9_PILARES, $@GRUPO9_PILARES + 1;
	if ($@PILARES_DONOS[$@LOOP] == 10) set $@GRUPO10_PILARES, $@GRUPO10_PILARES + 1;
	if ($@PILARES_DONOS[$@LOOP] == 11) set $@GRUPO11_PILARES, $@GRUPO11_PILARES + 1;
	if ($@PILARES_DONOS[$@LOOP] == 12) set $@GRUPO12_PILARES, $@GRUPO12_PILARES + 1;
	goto S_CONTAGEM;

S_COMPARA:
	if ($@GRUPO1_PILARES > $@VENCEDOR_PILARES) set $VENCEDOR_GRUPO,1;
	if ($@GRUPO1_PILARES > $@VENCEDOR_PILARES) set $@VENCEDOR_PILARES, $@GRUPO1_PILARES;
	if ($@GRUPO2_PILARES > $@VENCEDOR_PILARES) set $VENCEDOR_GRUPO,2;
	if ($@GRUPO2_PILARES > $@VENCEDOR_PILARES) set $@VENCEDOR_PILARES, $@GRUPO2_PILARES;
	if ($@GRUPO3_PILARES > $@VENCEDOR_PILARES) set $VENCEDOR_GRUPO,3;
	if ($@GRUPO3_PILARES > $@VENCEDOR_PILARES) set $@VENCEDOR_PILARES, $@GRUPO3_PILARES;
	if ($@GRUPO4_PILARES > $@VENCEDOR_PILARES) set $VENCEDOR_GRUPO,4;
	if ($@GRUPO4_PILARES > $@VENCEDOR_PILARES) set $@VENCEDOR_PILARES, $@GRUPO4_PILARES;
	if ($@GRUPO5_PILARES > $@VENCEDOR_PILARES) set $VENCEDOR_GRUPO,5;
	if ($@GRUPO5_PILARES > $@VENCEDOR_PILARES) set $@VENCEDOR_PILARES, $@GRUPO5_PILARES;
	if ($@GRUPO6_PILARES > $@VENCEDOR_PILARES) set $VENCEDOR_GRUPO,6;
	if ($@GRUPO6_PILARES > $@VENCEDOR_PILARES) set $@VENCEDOR_PILARES, $@GRUPO6_PILARES;
	if ($@GRUPO7_PILARES > $@VENCEDOR_PILARES) set $VENCEDOR_GRUPO,7;
	if ($@GRUPO7_PILARES > $@VENCEDOR_PILARES) set $@VENCEDOR_PILARES, $@GRUPO7_PILARES;
	if ($@GRUPO8_PILARES > $@VENCEDOR_PILARES) set $VENCEDOR_GRUPO,8;
	if ($@GRUPO8_PILARES > $@VENCEDOR_PILARES) set $@VENCEDOR_PILARES, $@GRUPO8_PILARES;
	if ($@GRUPO9_PILARES > $@VENCEDOR_PILARES) set $VENCEDOR_GRUPO,9;
	if ($@GRUPO9_PILARES > $@VENCEDOR_PILARES) set $@VENCEDOR_PILARES, $@GRUPO9_PILARES;
	if ($@GRUPO10_PILARES > $@VENCEDOR_PILARES) set $VENCEDOR_GRUPO,10;
	if ($@GRUPO10_PILARES > $@VENCEDOR_PILARES) set $@VENCEDOR_PILARES, $@GRUPO10_PILARES;
	if ($@GRUPO11_PILARES > $@VENCEDOR_PILARES) set $VENCEDOR_GRUPO,11;
	if ($@GRUPO11_PILARES > $@VENCEDOR_PILARES) set $@VENCEDOR_PILARES, $@GRUPO11_PILARES;
	if ($@GRUPO12_PILARES > $@VENCEDOR_PILARES) set $VENCEDOR_GRUPO,12;
	if ($@GRUPO12_PILARES > $@VENCEDOR_PILARES) set $@VENCEDOR_PILARES, $@GRUPO12_PILARES;
	return;

S_REPETIDOS:
	if ($@VENCEDOR_PILARES == 0) return;
	if ($VENCEDOR_GRUPO != 1 && $@GRUPO1_PILARES == $@VENCEDOR_PILARES) set $EMPATADOS[1], 1;
	if ($VENCEDOR_GRUPO != 2 && $@GRUPO2_PILARES == $@VENCEDOR_PILARES) set $EMPATADOS[2], 2;
	if ($VENCEDOR_GRUPO != 3 && $@GRUPO3_PILARES == $@VENCEDOR_PILARES) set $EMPATADOS[3], 3;
	if ($VENCEDOR_GRUPO != 4 && $@GRUPO4_PILARES == $@VENCEDOR_PILARES) set $EMPATADOS[4], 4;
	if ($VENCEDOR_GRUPO != 5 && $@GRUPO5_PILARES == $@VENCEDOR_PILARES) set $EMPATADOS[5], 5;
	if ($VENCEDOR_GRUPO != 6 && $@GRUPO6_PILARES == $@VENCEDOR_PILARES) set $EMPATADOS[6], 6;
	if ($VENCEDOR_GRUPO != 7 && $@GRUPO7_PILARES == $@VENCEDOR_PILARES) set $EMPATADOS[7], 7;
	if ($VENCEDOR_GRUPO != 8 && $@GRUPO8_PILARES == $@VENCEDOR_PILARES) set $EMPATADOS[8], 8;
	if ($VENCEDOR_GRUPO != 9 && $@GRUPO9_PILARES == $@VENCEDOR_PILARES) set $EMPATADOS[9], 9;
	if ($VENCEDOR_GRUPO != 10 && $@GRUPO10_PILARES == $@VENCEDOR_PILARES) set $EMPATADOS[10], 10;
	if ($VENCEDOR_GRUPO != 11 && $@GRUPO11_PILARES == $@VENCEDOR_PILARES) set $EMPATADOS[11], 11;
	if ($VENCEDOR_GRUPO != 12 && $@GRUPO12_PILARES == $@VENCEDOR_PILARES) set $EMPATADOS[12], 12;
	return;

S_DESEMPATE:
	if (getarraysize($EMPATADOS) == 1) return;
	if ($@MORTES_EVENTO_PILARES[1] > $@VENCEDOR_MORTES && $EMPATADOS[1] != 0) set $VENCEDOR_MORTES_GRUPO, 1;
	if ($@MORTES_EVENTO_PILARES[1] > $@VENCEDOR_MORTES && $EMPATADOS[1] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_PILARES[1];
	if ($@MORTES_EVENTO_PILARES[2] > $@VENCEDOR_MORTES && $EMPATADOS[2] != 0) set $VENCEDOR_MORTES_GRUPO, 2;
	if ($@MORTES_EVENTO_PILARES[2] > $@VENCEDOR_MORTES && $EMPATADOS[2] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_PILARES[2];
	if ($@MORTES_EVENTO_PILARES[3] > $@VENCEDOR_MORTES && $EMPATADOS[3] != 0) set $VENCEDOR_MORTES_GRUPO, 3;
	if ($@MORTES_EVENTO_PILARES[3] > $@VENCEDOR_MORTES && $EMPATADOS[3] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_PILARES[3];
	if ($@MORTES_EVENTO_PILARES[4] > $@VENCEDOR_MORTES && $EMPATADOS[4] != 0) set $VENCEDOR_MORTES_GRUPO, 4;
	if ($@MORTES_EVENTO_PILARES[4] > $@VENCEDOR_MORTES && $EMPATADOS[4] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_PILARES[4];
	if ($@MORTES_EVENTO_PILARES[5] > $@VENCEDOR_MORTES && $EMPATADOS[5] != 0) set $VENCEDOR_MORTES_GRUPO, 5;
	if ($@MORTES_EVENTO_PILARES[5] > $@VENCEDOR_MORTES && $EMPATADOS[5] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_PILARES[5];
	if ($@MORTES_EVENTO_PILARES[6] > $@VENCEDOR_MORTES && $EMPATADOS[6] != 0) set $VENCEDOR_MORTES_GRUPO, 6;
	if ($@MORTES_EVENTO_PILARES[6] > $@VENCEDOR_MORTES && $EMPATADOS[6] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_PILARES[6];
	if ($@MORTES_EVENTO_PILARES[7] > $@VENCEDOR_MORTES && $EMPATADOS[7] != 0) set $VENCEDOR_MORTES_GRUPO, 7;
	if ($@MORTES_EVENTO_PILARES[7] > $@VENCEDOR_MORTES && $EMPATADOS[7] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_PILARES[7];
	if ($@MORTES_EVENTO_PILARES[8] > $@VENCEDOR_MORTES && $EMPATADOS[8] != 0) set $VENCEDOR_MORTES_GRUPO, 8;
	if ($@MORTES_EVENTO_PILARES[8] > $@VENCEDOR_MORTES && $EMPATADOS[8] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_PILARES[8];
	if ($@MORTES_EVENTO_PILARES[9] > $@VENCEDOR_MORTES && $EMPATADOS[9] != 0) set $VENCEDOR_MORTES_GRUPO, 9;
	if ($@MORTES_EVENTO_PILARES[9] > $@VENCEDOR_MORTES && $EMPATADOS[9] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_PILARES[9];
	if ($@MORTES_EVENTO_PILARES[10] > $@VENCEDOR_MORTES && $EMPATADOS[10] != 0) set $VENCEDOR_MORTES_GRUPO, 10;
	if ($@MORTES_EVENTO_PILARES[10] > $@VENCEDOR_MORTES && $EMPATADOS[10] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_PILARES[10];
	if ($@MORTES_EVENTO_PILARES[11] > $@VENCEDOR_MORTES && $EMPATADOS[11] != 0) set $VENCEDOR_MORTES_GRUPO, 11;
	if ($@MORTES_EVENTO_PILARES[11] > $@VENCEDOR_MORTES && $EMPATADOS[11] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_PILARES[11];
	if ($@MORTES_EVENTO_PILARES[12] > $@VENCEDOR_MORTES && $EMPATADOS[12] != 0) set $VENCEDOR_MORTES_GRUPO, 12;
	if ($@MORTES_EVENTO_PILARES[12] > $@VENCEDOR_MORTES && $EMPATADOS[12] != 0) set $@VENCEDOR_MORTES, $@MORTES_EVENTO_PILARES[12];
	return;

S_DESEMPATE_REPETIDOS:
	if ($@VENCEDOR_MORTES == 0) return;
	if ($VENCEDOR_MORTES_GRUPO != 1 && $@MORTES_EVENTO_PILARES[1] == $@VENCEDOR_MORTES) set $EMPATADOS_MORTES[1], 1;
	if ($VENCEDOR_MORTES_GRUPO != 2 && $@MORTES_EVENTO_PILARES[2] == $@VENCEDOR_MORTES) set $EMPATADOS_MORTES[2], 2;
	if ($VENCEDOR_MORTES_GRUPO != 3 && $@MORTES_EVENTO_PILARES[3] == $@VENCEDOR_MORTES) set $EMPATADOS_MORTES[3], 3;
	if ($VENCEDOR_MORTES_GRUPO != 4 && $@MORTES_EVENTO_PILARES[4] == $@VENCEDOR_MORTES) set $EMPATADOS_MORTES[4], 4;
	if ($VENCEDOR_MORTES_GRUPO != 5 && $@MORTES_EVENTO_PILARES[5] == $@VENCEDOR_MORTES) set $EMPATADOS_MORTES[5], 5;
	if ($VENCEDOR_MORTES_GRUPO != 6 && $@MORTES_EVENTO_PILARES[6] == $@VENCEDOR_MORTES) set $EMPATADOS_MORTES[6], 6;
	if ($VENCEDOR_MORTES_GRUPO != 7 && $@MORTES_EVENTO_PILARES[7] == $@VENCEDOR_MORTES) set $EMPATADOS_MORTES[7], 7;
	if ($VENCEDOR_MORTES_GRUPO != 8 && $@MORTES_EVENTO_PILARES[8] == $@VENCEDOR_MORTES) set $EMPATADOS_MORTES[8], 8;
	if ($VENCEDOR_MORTES_GRUPO != 9 && $@MORTES_EVENTO_PILARES[9] == $@VENCEDOR_MORTES) set $EMPATADOS_MORTES[9], 9;
	if ($VENCEDOR_MORTES_GRUPO != 10 && $@MORTES_EVENTO_PILARES[10] == $@VENCEDOR_MORTES) set $EMPATADOS_MORTES[10], 10;
	if ($VENCEDOR_MORTES_GRUPO != 11 && $@MORTES_EVENTO_PILARES[11] == $@VENCEDOR_MORTES) set $EMPATADOS_MORTES[11], 11;
	if ($VENCEDOR_MORTES_GRUPO != 12 && $@MORTES_EVENTO_PILARES[12] == $@VENCEDOR_MORTES) set $EMPATADOS_MORTES[12], 12;
	return;

L_Limpar:
	set $@EVENTO_STATUS, 0;
	set $@EVENTO_DEBUG, 0;
	set $@EVENTO_INICIO, 0;
	cleararray $@GRUPOS_AUTOEVENTO$[0], "", 13;
	cleararray $@GRUPO1$[0], "", 13;
	cleararray $@GRUPO2$[0], "", 13;
	cleararray $@GRUPO3$[0], "", 13;
	cleararray $@GRUPO4$[0], "", 13;
	cleararray $@GRUPO5$[0], "", 13;
	cleararray $@GRUPO6$[0], "", 13;
	cleararray $@GRUPO7$[0], "", 13;
	cleararray $@GRUPO8$[0], "", 13;
	cleararray $@GRUPO9$[0], "", 13;
	cleararray $@GRUPO10$[0], "", 13;
	cleararray $@GRUPO11$[0], "", 13;
	cleararray $@GRUPO12$[0], "", 13;
	cleararray $@MORTES_EVENTO_PILARES[0], 0, 13;
	set $@GRUPO1_PILARES, 0;
	set $@GRUPO2_PILARES, 0;
	set $@GRUPO3_PILARES, 0;
	set $@GRUPO4_PILARES, 0;
	set $@GRUPO5_PILARES, 0;
	set $@GRUPO6_PILARES, 0;
	set $@GRUPO7_PILARES, 0;
	set $@GRUPO8_PILARES, 0;
	set $@GRUPO9_PILARES, 0;
	set $@GRUPO10_PILARES, 0;
	set $@GRUPO11_PILARES, 0;
	set $@GRUPO12_PILARES, 0;
	cleararray $@PILARES_DONOS[0], 0, 13;
	killmonster "002.gat", "#Controle::OnPilar1Death";
	killmonster "002.gat", "#Controle::OnPilar2Death";
	killmonster "002.gat", "#Controle::OnPilar3Death";
	killmonster "002.gat", "#Controle::OnPilar4Death";
	killmonster "002.gat", "#Controle::OnPilar5Death";
	killmonster "002.gat", "#Controle::OnPilar6Death";
	killmonster "002.gat", "#Controle::OnPilar7Death";
	killmonster "002.gat", "#Controle::OnPilar8Death";
	killmonster "002.gat", "#Controle::OnPilar9Death";
	killmonster "002.gat", "#Controle::OnPilar10Death";
	killmonster "002.gat", "#Controle::OnPilar11Death";
	killmonster "002.gat", "#Controle::OnPilar12Death";
	end;

onInit:
	initnpctimer;
	end;

}
